<h2 id="overview">Overview</h2>

<p>The Okta Authentication API provides operations to authenticate users, perform multi-factor enrollment and verification, recover forgotten passwords, and unlock accounts. It can be used as a standalone API to provide the identity layer on top of your existing application, or it can be integrated with the Okta <a href="sessions.html">Sessions API</a> to obtain an Okta <a href="/docs/examples/session_cookie.html">session cookie</a> and access apps within Okta.</p>

<p>The API is targeted for developers who want to build their own end-to-end login experience to replace the built-in Okta login experience and addresses the following key scenarios:</p>

<ul>
  <li>
    <p><strong>Primary authentication</strong> allows you to verify username and password credentials for a user.</p>
  </li>
  <li>
    <p><strong>Multifactor authentication</strong> (MFA) strengthens the security of password-based authentication by requiring additional verification of another factor such as a temporary one-time password or an SMS passcode. The Authentication API supports user enrollment with MFA factors enabled by the administrator, as well as MFA challenges based on your <strong>Okta Sign-On Policy</strong>.</p>
  </li>
  <li>
    <p><strong>Recovery</strong> allows users to securely reset their password if they’ve forgotten it, or unlock their account if it has been locked out due to excessive failed login attempts. This functionality is subject to the security policy set by the administrator.</p>
  </li>
</ul>

<blockquote>
  <p>The <a href="/docs/guides/okta_sign-in_widget.html">Okta Sign-In Widget</a> is built on this API and is recommended for quick integration if you don’t have advanced use cases</p>
</blockquote>

<h3 id="application-types">Application Types</h3>

<p>The behavior of the Okta Authentication API varies depending on the type of your application and your org’s security policies such as the <strong>Okta Sign-On Policy</strong>, <strong>MFA Enrollment Policy</strong>, or <strong>Password Policy</strong>.</p>

<blockquote>
  <p>Policy evaluation is conditional on the <a href="../getting_started/design_principles.html#client-request-context">client request context</a> such as IP address.</p>
</blockquote>

<h4 id="public-application">Public Application</h4>

<p>Public applications are any application that anonymously start an authentication or recovery transaction without an API token such as the <a href="/docs/guides/okta_sign-in_widget.html">Okta Sign-In Widget</a>.  Public applications are aggressively rate-limited to prevent abuse and require primary authentication to be successfully completed before releasing any metadata about a user.</p>

<h4 id="trusted-application">Trusted Application</h4>

<p>Trusted applications are backend applications that act as authentication broker or login portal for your Okta organization and may start an authentication or recovery transaction with an administrator API token.  Trusted apps  may implement their own recovery flows and primary authentication process and may receive additional metadata about the user before primary authentication has successfully completed.</p>

<blockquote>
  <p>Trusted web applications may need to override <a href="../getting_started/design_principles.html#client-request-context">client request context</a> to forward the originating client context for the user.</p>
</blockquote>

<h2 id="transaction-model">Transaction Model</h2>

<p>The Authentication API is a <em>stateful</em> API that implements a finite state machine with <a href="#transaction-state">defined states</a> and transitions.  Each authentication or recovery transaction is issued a unique <a href="#state-token">state token</a> that must be passed with each subsequent request until the transaction is complete or canceled.</p>

<p>The Authentication API leverages the <a href="http://tools.ietf.org/html/draft-kelly-json-hal-06">JSON HAL</a> format to publish <code>next</code> and <code>prev</code> links for the current transaction state which should be used to transition the state machine.</p>

<h3 id="authentication-transaction-model">Authentication Transaction Model</h3>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>DataType</th>
      <th>Nullable</th>
      <th>Readonly</th>
      <th>MinLength</th>
      <th>MaxLength</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>stateToken</td>
      <td>ephemeral <a href="#state-token">token</a> that encodes the current state of an authentication transaction</td>
      <td>String</td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>sessionToken</td>
      <td>ephemeral <a href="#session-token">one-time token</a> used to bootstrap an Okta session</td>
      <td>String</td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>expiresAt</td>
      <td>lifetime of the <code>stateToken</code> or <code>sessionToken</code> (See <a href="#tokens">Tokens</a>)</td>
      <td>Date</td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>status</td>
      <td>current <a href="#transaction-state">state</a> of the authentication transaction</td>
      <td><a href="#transaction-state">Transaction State</a></td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>relayState</td>
      <td>optional opaque value that is persisted for the lifetime of the authentication transaction</td>
      <td>String</td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td>2048</td>
      <td> </td>
    </tr>
    <tr>
      <td>factorResult</td>
      <td>optional status of last verification attempt for a given factor</td>
      <td><a href="#factor-result">Factor Result</a></td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>_embedded</td>
      <td><a href="#embedded-resources">embedded resources</a> for the current <code>status</code></td>
      <td><a href="http://tools.ietf.org/html/draft-kelly-json-hal-06">JSON HAL</a></td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>_links</td>
      <td><a href="#links-object">link relations</a> for the current <code>status</code></td>
      <td><a href="http://tools.ietf.org/html/draft-kelly-json-hal-06">JSON HAL</a></td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>The <code>relayState</code> paramater is an opaque value for the transaction and processed as untrusted data which is just echoed in a response.  It is the client’s responsibility to escape/encode this value before displaying in a UI such as a HTML document using <a href="https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet">best-practices</a></p>
</blockquote>

<h3 id="recovery-transaction-model">Recovery Transaction Model</h3>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>DataType</th>
      <th>Nullable</th>
      <th>Readonly</th>
      <th>MinLength</th>
      <th>MaxLength</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>stateToken</td>
      <td>ephemeral <a href="#state-token">token</a> that encodes the current state of a recovery transaction</td>
      <td>String</td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>recoveryToken</td>
      <td>ephemeral <a href="#recovery-token">one-time token</a> for recovery transaction to be distributed to the end-user</td>
      <td>String</td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>expiresAt</td>
      <td>lifetime of the <code>stateToken</code> or <code>recoveryToken</code> (See <a href="#tokens">Tokens</a>)</td>
      <td>Date</td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>status</td>
      <td>current <a href="#transaction-state">state</a> of the recovery transaction</td>
      <td><a href="#transaction-state">Transaction State</a></td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>relayState</td>
      <td>optional opaque value that is persisted for the lifetime of the recovery transaction</td>
      <td>String</td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td>2048</td>
      <td> </td>
    </tr>
    <tr>
      <td>factorType</td>
      <td>type of selected factor for the recovery transaction</td>
      <td><code>EMAIL</code> or <code>SMS</code></td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>recoveryType</td>
      <td>type of recovery operation</td>
      <td><code>PASSWORD</code> or <code>UNLOCK</code></td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>factorResult</td>
      <td>optional status of last verification attempt for the <code>factorType</code></td>
      <td><a href="#factor-result">Factor Result</a></td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>_embedded</td>
      <td><a href="#embedded-resources">embedded resources</a> for the current <code>status</code></td>
      <td><a href="http://tools.ietf.org/html/draft-kelly-json-hal-06">JSON HAL</a></td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>_links</td>
      <td><a href="#links-object">link relations</a> for the current <code>status</code></td>
      <td><a href="http://tools.ietf.org/html/draft-kelly-json-hal-06">JSON HAL</a></td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>The <code>relayState</code> paramater is an opaque value for the transaction and processed as untrusted data which is just echoed in a response.  It is the client’s responsibility to escape/encode this value before displaying in a UI such as a HTML document using <a href="https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet">best-practices</a></p>
</blockquote>

<h3 id="transaction-state">Transaction State</h3>

<p><img src="/assets/img/auth-state-model.png" alt="State Model Diagram" title="State Model Diagram" /></p>

<p>An authentication or recovery transaction has one of the following states:</p>

<table>
  <thead>
    <tr>
      <th>Value</th>
      <th>Description</th>
      <th>Next Action</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>PASSWORD_WARN</code></td>
      <td>The user’s password was successfully validated but is about to expire and should be changed.</td>
      <td>POST to the <code>next</code> link relation to <a href="#change-password">change the user’s password</a>.</td>
    </tr>
    <tr>
      <td><code>PASSWORD_EXPIRED</code></td>
      <td>The user’s password was successfully validated but is expired.</td>
      <td>POST to the <code>next</code> link relation to <a href="#change-password">change the user’s expired password</a>.</td>
    </tr>
    <tr>
      <td><code>RECOVERY</code></td>
      <td>The user has requested a recovery token to reset their password or unlock their account.</td>
      <td>POST to the <code>next</code> link relation to <a href="#answer-recovery-question">answer the user’s recovery question</a>.</td>
    </tr>
    <tr>
      <td><code>RECOVERY_CHALLENGE</code></td>
      <td>The user must verify the factor-specific recovery challenge.</td>
      <td>POST to the <code>verify</code> link relation to <a href="#verify-recovery-factor">verify the recovery factor</a>.</td>
    </tr>
    <tr>
      <td><code>PASSWORD_RESET</code></td>
      <td>The user successfully answered their recovery question and must to set a new password.</td>
      <td>POST to the <code>next</code> link relation to <a href="#reset-password">reset the user’s password</a>.</td>
    </tr>
    <tr>
      <td><code>LOCKED_OUT</code></td>
      <td>The user account is locked; self-service unlock or admin unlock is required.</td>
      <td>POST to the <code>unlock</code> link relation to perform a <a href="#unlock-account">self-service unlock</a>.</td>
    </tr>
    <tr>
      <td><code>MFA_ENROLL</code></td>
      <td>The user must select and enroll an available factor for additional verification.</td>
      <td>POST to the <code>enroll</code> link relation for a specific factor to <a href="#enroll-factor">enroll the factor</a>.</td>
    </tr>
    <tr>
      <td><code>MFA_ENROLL_ACTIVATE</code></td>
      <td>The user must activate the factor to complete enrollment.</td>
      <td>POST to the <code>next</code> link relation to <a href="#activate-factor">activate the factor</a>.</td>
    </tr>
    <tr>
      <td><code>MFA_REQUIRED</code></td>
      <td>The user must provide additional verification with a previously enrolled factor.</td>
      <td>POST to the <code>verify</code> link relation for a specific factor to <a href="#verify-factor">provide additional verification</a>.</td>
    </tr>
    <tr>
      <td><code>MFA_CHALLENGE</code></td>
      <td>The user must verify the factor-specific challenge.</td>
      <td>POST to the <code>verify</code> link relation to <a href="#verify-factor">verify the factor</a>.</td>
    </tr>
    <tr>
      <td><code>SUCCESS</code></td>
      <td>The transaction has completed successfully</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>You advance the authentication or recovery transaction to the next state by posting a request with a valid <a href="#state-token">state token</a> to the the <code>next</code> link relation published in the <a href="#links-object">JSON HAL links object</a> for the response.</p>

<p><a href="#enroll-factor">Enrolling a factor</a> and <a href="#verify-factor">verifying a factor</a> do not have <code>next</code> link relationships as the end-user must make a selection of which factor to enroll or verify.</p>

<blockquote>
  <p>You should never assume a specific state transition or URL when navigating the <a href="#transaction-state">state model</a>.  Always inspect the response for <code>status</code> and dynamically follow the <a href="#links-object">published link relations</a>.</p>
</blockquote>

<pre><code class="language-json">{
  "_links": {
    "next": {
      "name": "activate",
      "href": "https://your-domain.okta.com/api/v1/authn/factors/ostf2xjtDKWFPZIKYDZV/lifecycle/activate",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "prev": {
      "href": "https://your-domain.okta.com/api/v1/authn/previous",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "skip": {
      "href": "https://your-domain.okta.com/api/v1/authn/skip",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h3 id="tokens">Tokens</h3>

<p>Authentication API operations will return different token types depending on the <a href="#transaction-state">state</a> of the authentication or recovery transaction.</p>

<h4 id="state-token">State Token</h4>

<p>Ephemeral token that encodes the current state of an authentication or recovery transaction.</p>

<ul>
  <li>The <code>stateToken</code> must be passed with every request except when verifying a <code>recoveryToken</code> that was distributed out-of-band</li>
  <li>The <code>stateToken</code> is only intended to be used between the web application performing end-user authentication and the Okta API. It should never distributed to the end-user via email or other out-of-band mechanism.</li>
  <li>The lifetime of the <code>stateToken</code> uses a sliding scale expiration algorithm that extends with every request.  Always introspect the <code>expiresAt</code> property for the transaction when making decisions based on lifetime.</li>
</ul>

<blockquote>
  <p>All Authentication API operations will return <code>401 Unauthorized</code> status code when you attempt to use an expired state token.</p>
</blockquote>

<pre><code class="language-http">HTTP/1.1 401 Unauthorized
Content-Type: application/json

{
  "errorCode": "E0000011",
  "errorSummary": "Invalid token provided",
  "errorLink": "E0000011",
  "errorId": "oaeY-4G_TBUTBSZAn9n7oZCfw",
  "errorCauses": []
}
</code></pre>

<blockquote>
  <p>State transitions are strictly enforced for state tokens.  You will receive a <code>403 Forbidden</code> status code if you call an Authentication API operation with a <code>stateToken</code> with an invalid <a href="#transaction-state">state</a>.</p>
</blockquote>

<pre><code class="language-http">HTTP/1.1 403 Forbidden
Content-Type: application/json

{
  "errorCode": "E0000079",
  "errorSummary": "This operation is not allowed in the current authentication state.",
  "errorLink": "E0000079",
  "errorId": "oaen9Ly_ivHQJ-STb8KiADh9w",
  "errorCauses": [
    {
      "errorSummary": "This operation is not allowed in the current authentication state."
    }
  ]
}
</code></pre>

<h4 id="recovery-token">Recovery Token</h4>

<p>One-time token issued as <code>recoveryToken</code> response parameter when a recovery transaction transitions to the <code>RECOVERY</code> status.</p>

<ul>
  <li>The token can be exchanged for a <code>stateToken</code> to recover a user’s password or unlock their account.</li>
  <li>Unlike the <code>statusToken</code> the <code>recoveryToken</code> should be distributed out-of-band to a user such as via email.</li>
  <li>The lifetime of the <code>recoveryToken</code> is managed by the organization’s security policy.</li>
</ul>

<p>The <code>recoveryToken</code> is sent via an out-of-band channel to the end-user’s verified email address or SMS phone number and acts as primary authentication for the recovery transaction.</p>

<blockquote>
  <p>Directly obtaining a <code>recoveryToken</code> is a highly privileged operation and should be restricted to trusted web applications.  Anyone that obtains a <code>recoveryToken</code> for a user and knows the answer to a user’s recovery question can reset their password or unlock their account.</p>
</blockquote>

<h4 id="session-token">Session Token</h4>

<p>One-time token issued as <code>sessionToken</code> response parameter when an authentication transaction completes with the <code>SUCCESS</code> status.</p>

<ul>
  <li>The token can be exchanged for a session with the <a href="sessions.html#create-session-with-session-token">Session API</a> or converted to a <a href="/docs/examples/session_cookie.html">session cookie</a>.</li>
  <li>The lifetime of the <code>sessionToken</code> is the same as the lifetime of a user’s session and managed by the organization’s security policy.</li>
</ul>

<h3 id="factor-result">Factor Result</h3>

<p>The <code>MFA_CHALLENGE</code> or <code>RECOVERY_CHALLENGE</code> state can return an additional property <strong>factorResult</strong> that provides additional context for the last factor verification attempt.</p>

<p>The following table shows the possible values for this property:</p>

<table>
  <thead>
    <tr>
      <th>factorResult</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>WAITING</code></td>
      <td>Factor verification has started but not yet completed (e.g user hasn’t answered phone call yet)</td>
    </tr>
    <tr>
      <td><code>CANCELLED</code></td>
      <td>Factor verification was canceled by user</td>
    </tr>
    <tr>
      <td><code>TIMEOUT</code></td>
      <td>Unable to verify factor within the allowed time window</td>
    </tr>
    <tr>
      <td><code>TIME_WINDOW_EXCEEDED</code></td>
      <td>Factor was successfully verified but outside of the computed time window.  Another verification is required in current time window.</td>
    </tr>
    <tr>
      <td><code>PASSCODE_REPLAYED</code></td>
      <td>Factor was previously verified within the same time window.  User must wait another time window and retry with a new verification.</td>
    </tr>
    <tr>
      <td><code>ERROR</code></td>
      <td>Unexpected server error occurred verifying factor.</td>
    </tr>
  </tbody>
</table>

<h3 id="links-object">Links Object</h3>

<p>Specifies link relations (See <a href="http://tools.ietf.org/html/rfc5988">Web Linking</a>) available for the current <a href="#transaction-state">transaction state</a> using the <a href="http://tools.ietf.org/html/draft-kelly-json-hal-06">JSON Hypertext Application Language</a> specification.  These links are used to transition the <a href="#transaction-state">state machine</a> of the authentication or recovery transaction.</p>

<table>
  <thead>
    <tr>
      <th>Link Relation Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>next</td>
      <td>Transitions the  <a href="#transaction-state">state machine</a> to the next state.  <strong>Note: The <code>name</code> of the link relationship will provide a hint of the next operation required</strong></td>
    </tr>
    <tr>
      <td>prev</td>
      <td>Transitions the  <a href="#transaction-state">state machine</a> to the previous state.</td>
    </tr>
    <tr>
      <td>cancel</td>
      <td>Cancels the current  transaction and revokes the <a href="#state-token">state token</a>.</td>
    </tr>
    <tr>
      <td>skip</td>
      <td>Skips over the current  transaction state to the next valid <a href="#transaction-state">state</a></td>
    </tr>
    <tr>
      <td>resend</td>
      <td>Resends a challenge or OTP to a device</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>The Links Object is <strong>read-only</strong></p>
</blockquote>

<h2 id="embedded-resources">Embedded Resources</h2>

<h3 id="user-object">User Object</h3>

<p>A subset of <a href="users.html#user-model">user properties</a> published in an authentication or recovery transaction after the user successfully completes primary authentication.</p>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>DataType</th>
      <th>Nullable</th>
      <th>Unique</th>
      <th>Readonly</th>
      <th>MinLength</th>
      <th>MaxLength</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>id</td>
      <td>unique key for user</td>
      <td>String</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>passwordChanged</td>
      <td>timestamp when user’s password last changed</td>
      <td>Date</td>
      <td>TRUE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>profile</td>
      <td>user’s profile</td>
      <td><a href="#user-profile-object">User Profile Object</a></td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>recovery_question</td>
      <td>user’s recovery question</td>
      <td><a href="#recovery-question-object">Recovery Question Object</a></td>
      <td>TRUE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<pre><code class="language-json">{
 "id": "00udnlQDVLVRIVXESCMZ",
 "passwordChanged": "2015-09-08T20:14:45.000Z",
 "profile": {
    "login": "dade.murphy@example.com",
    "firstName":"Dade",
    "lastName": "Murphy",
    "locale": "en_US",
    "timeZone": "America/Los_Angeles"
 },
 "recovery_question": {
    "question": "Who's a major player in the cowboy scene?"
  }
}
</code></pre>

<h4 id="user-profile-object">User Profile Object</h4>

<p>Subset of <a href="users.html#profile-object">profile properties</a> for a user</p>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>DataType</th>
      <th>Nullable</th>
      <th>Unique</th>
      <th>Readonly</th>
      <th>MinLength</th>
      <th>MaxLength</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>login</td>
      <td>unique login for user</td>
      <td>String</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>firstName</td>
      <td>first name of user</td>
      <td>String</td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>lastName</td>
      <td>last name of user</td>
      <td>String</td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>locale</td>
      <td>user’s default location for purposes of localizing items such as currency, date time format, numerical representations, etc.</td>
      <td>String</td>
      <td>TRUE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td><a href="https://tools.ietf.org/html/rfc5646">RFC 5646</a></td>
    </tr>
    <tr>
      <td>timeZone</td>
      <td>user’s time zone</td>
      <td>String</td>
      <td>TRUE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td><a href="https://tools.ietf.org/html/rfc6557">IANA Time Zone database format</a></td>
    </tr>
  </tbody>
</table>

<h4 id="recovery-question-object">Recovery Question Object</h4>

<p>User’s recovery question used for verification of a recovery transaction</p>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>DataType</th>
      <th>Nullable</th>
      <th>Unique</th>
      <th>Readonly</th>
      <th>MinLength</th>
      <th>MaxLength</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>question</td>
      <td>user’s recovery question</td>
      <td>String</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h3 id="password-policy-object">Password Policy Object</h3>

<p>A subset of policy settings for the user’s assigned password policy published during <code>PASSWORD_WARN</code>, <code>PASSWORD_EXPIRED</code>, or <code>PASSWORD_RESET</code> states</p>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>DataType</th>
      <th>Nullable</th>
      <th>Unique</th>
      <th>Readonly</th>
      <th>MinLength</th>
      <th>MaxLength</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>expiration</td>
      <td>password expiration settings</td>
      <td><a href="#password-expiration-object">Password Expiration Object</a></td>
      <td>TRUE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>complexity</td>
      <td>password complexity settings</td>
      <td><a href="#password-complexity-object">Password Complexity Object</a></td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<pre><code class="language-json">{
  "expiration": {
    "passwordExpireDays": 0
  },
  "complexity": {
    "minLength": 8,
    "minLowerCase": 1,
    "minUpperCase": 1,
    "minNumber": 1,
    "minSymbol": 0
  }
}
</code></pre>

<h4 id="password-expiration-object">Password Expiration Object</h4>

<p>Specifies the password age requirements of the assigned password policy</p>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>DataType</th>
      <th>Nullable</th>
      <th>Unique</th>
      <th>Readonly</th>
      <th>MinLength</th>
      <th>MaxLength</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>passwordExpireDays</td>
      <td>number of days before password is expired</td>
      <td>Number</td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h4 id="password-complexity-object">Password Complexity Object</h4>

<p>Specifies the password complexity requirements of the assigned password policy</p>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>DataType</th>
      <th>Nullable</th>
      <th>Unique</th>
      <th>Readonly</th>
      <th>MinLength</th>
      <th>MaxLength</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>minLength</td>
      <td>minimum number of characters for password</td>
      <td>Number</td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>minLowerCase</td>
      <td>minimum number of lower case characters for password</td>
      <td>Number</td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>minUpperCase</td>
      <td>minimum number of upper case characters for password</td>
      <td>Number</td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>minNumber</td>
      <td>minimum number of numeric characters for password</td>
      <td>Number</td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>minSymbol</td>
      <td>minimum number of symbol characters for password</td>
      <td>Number</td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h3 id="factor-object">Factor Object</h3>

<p>A subset of <a href="factors.html#factor-model">factor properties</a> published in an authentication transaction during <code>MFA_ENROLL</code>, <code>MFA_REQUIRED</code>, or <code>MFA_CHALLENGE</code> states</p>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>DataType</th>
      <th>Nullable</th>
      <th>Unique</th>
      <th>Readonly</th>
      <th>MinLength</th>
      <th>MaxLength</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>id</td>
      <td>unique key for factor</td>
      <td>String</td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>factorType</td>
      <td>type of factor</td>
      <td><a href="factors.html#factor-type">Factor Type</a></td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>provider</td>
      <td>factor provider</td>
      <td><a href="factors.html#provider-type">Provider Type</a></td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>profile</td>
      <td>profile of a <a href="factors.html#supported-factors-for-providers">supported factor</a></td>
      <td><a href="factors.html#factor-profile-object">Factor Profile Object</a></td>
      <td>TRUE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>_embedded</td>
      <td><a href="#factor-embedded-resources">embedded resources</a> related to the factor</td>
      <td><a href="http://tools.ietf.org/html/draft-kelly-json-hal-06">JSON HAL</a></td>
      <td>TRUE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>_links</td>
      <td><a href="#factor-links-object">discoverable resources</a> for the factor</td>
      <td><a href="http://tools.ietf.org/html/draft-kelly-json-hal-06">JSON HAL</a></td>
      <td>TRUE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<pre><code class="language-json">{
  "id": "ostfm3hPNYSOIOIVTQWY",
  "factorType": "token:software:totp",
  "provider": "OKTA",
  "profile": {
    "credentialId": "dade.murphy@example.com"
  },
  "_links": {
    "verify": {
      "href": "https://your-domain.okta.com/api/v1/authn/factors/ostfm3hPNYSOIOIVTQWY/verify",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h4 id="factor-embedded-resources">Factor Embedded Resources</h4>

<h5 id="totp-factor-activation-object">TOTP Factor Activation Object</h5>

<p>TOTP factors when activated have an embedded verification object which describes the <a href="http://tools.ietf.org/html/rfc6238">TOTP</a> algorithm parameters.</p>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>DataType</th>
      <th>Nullable</th>
      <th>Unique</th>
      <th>Readonly</th>
      <th>MinLength</th>
      <th>MaxLength</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>timeStep</td>
      <td>time-step size for TOTP</td>
      <td>String</td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>sharedSecret</td>
      <td>unique secret key for prover</td>
      <td>String</td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>encoding</td>
      <td>encoding of <code>sharedSecret</code></td>
      <td><code>base32</code> or <code>base64</code></td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>keyLength</td>
      <td>number of digits in an TOTP value</td>
      <td>Number</td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>_links</td>
      <td>discoverable resources related to the activation</td>
      <td><a href="http://tools.ietf.org/html/draft-kelly-json-hal-06">JSON HAL</a></td>
      <td>TRUE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<pre><code class="language-json">{
  "activation": {
    "timeStep": 30,
    "sharedSecret": "HE64TMLL2IUZW2ZLB",
    "encoding": "base32",
    "keyLength": 6
  }
}
</code></pre>

<h6 id="totp-activation-links-object">TOTP Activation Links Object</h6>

<p>Specifies link relations (See <a href="http://tools.ietf.org/html/rfc5988">Web Linking</a>) available for the TOTP activation object using the <a href="http://tools.ietf.org/html/draft-kelly-json-hal-06">JSON Hypertext Application Language</a> specification.  This object is used for dynamic discovery of related resources and operations.</p>

<table>
  <thead>
    <tr>
      <th>Link Relation Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>qrcode</td>
      <td>QR code that encodes the TOTP parameters that can be used for enrollment</td>
    </tr>
  </tbody>
</table>

<h5 id="phone-object">Phone Object</h5>

<p>The phone object describes previously enrolled phone numbers for the <code>sms</code> factor.</p>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>DataType</th>
      <th>Nullable</th>
      <th>Unique</th>
      <th>Readonly</th>
      <th>MinLength</th>
      <th>MaxLength</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>id</td>
      <td>unique key for phone</td>
      <td>String</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>profile</td>
      <td>profile of phone</td>
      <td><a href="#phone-profile-object">Phone Profile Object</a></td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>status</td>
      <td>status of phone</td>
      <td><code>ACTIVE</code> or <code>INACTIVE</code></td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<pre><code class="language-json">{
    "id": "mbl198rKSEWOSKRIVIFT",
    "profile": {
        "phoneNumber": "+1 XXX-XXX-1337"
    },
    "status": "ACTIVE"
}
</code></pre>

<h6 id="phone-profile-object">Phone Profile Object</h6>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>DataType</th>
      <th>Nullable</th>
      <th>Unique</th>
      <th>Readonly</th>
      <th>MinLength</th>
      <th>MaxLength</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>phoneNumber</td>
      <td>masked phone number</td>
      <td>String</td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h5 id="phone-object-1">Phone Object</h5>

<p>The phone object describes previously enrolled phone numbers for the <code>sms</code> factor.</p>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>DataType</th>
      <th>Nullable</th>
      <th>Unique</th>
      <th>Readonly</th>
      <th>MinLength</th>
      <th>MaxLength</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>id</td>
      <td>unique key for phone</td>
      <td>String</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>profile</td>
      <td>profile of phone</td>
      <td><a href="#phone-profile-object">Phone Profile Object</a></td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>status</td>
      <td>status of phone</td>
      <td><code>ACTIVE</code> or <code>INACTIVE</code></td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h5 id="push-factor-activation-object">Push Factor Activation Object</h5>

<p>Push factors must complete activation on the device by scanning the QR code or visiting activation link sent via email or sms.</p>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>DataType</th>
      <th>Nullable</th>
      <th>Unique</th>
      <th>Readonly</th>
      <th>MinLength</th>
      <th>MaxLength</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>expiresAt</td>
      <td>lifetime of activation</td>
      <td>Date</td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>_links</td>
      <td>discoverable resources related to the activation</td>
      <td><a href="http://tools.ietf.org/html/draft-kelly-json-hal-06">JSON HAL</a></td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<pre><code class="language-json">{
  "activation": {
    "expiresAt": "2015-11-13T07:44:22.000Z",
    "_links": {
      "send": [
        {
          "name": "email",
          "href": "https://your-domain.okta.com/api/v1/users/00u15s1KDETTQMQYABRL/factors/opfbtzzrjgwauUsxO0g4/lifecycle/activate/email",
          "hints": {
            "allow": [
              "POST"
            ]
          }
        },
        {
          "name": "sms",
          "href": "https://your-domain.okta.com/api/v1/users/00u15s1KDETTQMQYABRL/factors/opfbtzzrjgwauUsxO0g4/lifecycle/activate/sms",
          "hints": {
            "allow": [
              "POST"
            ]
          }
        }
      ],
      "qrcode": {
        "href": "https://your-domain.okta.com/api/v1/users/00u15s1KDETTQMQYABRL/factors/opfbtzzrjgwauUsxO0g4/qr/00Ji8qVBNJD4LmjYy1WZO2VbNqvvPdaCVua-1qjypa",
        "type": "image/png"
      }
    }
  }
}
</code></pre>

<h6 id="push-factor-activation-links-object">Push Factor Activation Links Object</h6>

<p>Specifies link relations (See <a href="http://tools.ietf.org/html/rfc5988">Web Linking</a>) available for the push factor activation object using the <a href="http://tools.ietf.org/html/draft-kelly-json-hal-06">JSON Hypertext Application Language</a> specification.  This object is used for dynamic discovery of related resources and operations.</p>

<table>
  <thead>
    <tr>
      <th>Link Relation Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>qrcode</td>
      <td>QR code that encodes the push activation code needed for enrollment on the device</td>
    </tr>
    <tr>
      <td>send</td>
      <td>Sends an activation link via <code>email</code> or <code>sms</code> for users who can’t scan the QR code</td>
    </tr>
  </tbody>
</table>

<h5 id="factor-links-object">Factor Links Object</h5>

<p>Specifies link relations (See <a href="http://tools.ietf.org/html/rfc5988">Web Linking</a>) available for the factor using the <a href="http://tools.ietf.org/html/draft-kelly-json-hal-06">JSON Hypertext Application Language</a> specification.  This object is used for dynamic discovery of related resources and operations.</p>

<table>
  <thead>
    <tr>
      <th>Link Relation Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>enroll</td>
      <td><a href="#enroll-factor">Enrolls a factor</a></td>
    </tr>
    <tr>
      <td>verify</td>
      <td><a href="#verify-factor">Verifies a factor</a></td>
    </tr>
    <tr>
      <td>questions</td>
      <td>Lists all possible questions for the <code>question</code> factor type</td>
    </tr>
    <tr>
      <td>resend</td>
      <td>Resends a challenge or OTP to a device</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>The Links Object is <strong>read-only</strong></p>
</blockquote>

<h2 id="authentication-operations">Authentication Operations</h2>

<h3 class="api api-operation" id="primary-authentication">Primary Authentication</h3>

<p><span class="api-uri-template api-uri-post"><span class="api-label">POST</span> /authn</span></p>

<p>Every authentication transaction starts with primary authentication which validates a user’s primary password credential.  <strong>Password Policy</strong>, <strong>MFA Policy</strong>,  and <strong>Sign-On Policy</strong> is evaluated during primary authentication to determine if the user’s password is expired, a factor should be enrolled, or additional verification is required.</p>

<p>The <a href="#transaction-state">transaction state</a> of the response will depend on the user’s status, group memberships and assigned policies.</p>

<ul>
  <li><a href="#primary-authentication-with-public-application">Primary Authentication with Public Application</a></li>
  <li><a href="#primary-authentication-with-trusted-application">Primary Authentication with Trusted Application</a></li>
  <li><a href="#primary-authentication-with-password-expiration-warn">Primary Authentication with Password Expiration Warn</a></li>
</ul>

<blockquote>
  <p>You must first enable MFA factors and assign a valid <strong>Sign-On Policy</strong> to a user to enroll and/or verify a MFA factor during authentication</p>
</blockquote>

<h4 class="api api-request api-request-params" id="request-parameters">Request Parameters</h4>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
      <th>MaxLength</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>username</td>
      <td>User’s non-qualified short-name (e.g. dade.murphy) or unique fully-qualified login (e.g dade.murphy@example.com)</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>password</td>
      <td>User’s password credential</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>relayState</td>
      <td>Optional state value that is persisted for the lifetime of the authentication transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>FALSE</td>
      <td> </td>
      <td>2048</td>
    </tr>
    <tr>
      <td>options</td>
      <td>Opt-in features for the authentication transaction</td>
      <td>Body</td>
      <td><a href="#options-object">Options Object</a></td>
      <td>FALSE</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>context</td>
      <td>Provides additional context for the authentication transaction</td>
      <td>Body</td>
      <td><a href="#context-object">Context Object</a></td>
      <td>FALSE</td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h5 id="options-object">Options Object</h5>

<p>The authentication transaction <a href="#transaction-state">state machine</a> can be modified via the following opt-in features:</p>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>DataType</th>
      <th>Nullable</th>
      <th>Unique</th>
      <th>Readonly</th>
      <th>MinLength</th>
      <th>MaxLength</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>multiOptionalFactorEnroll</td>
      <td>Transitions transaction back to <code>MFA_ENROLL</code> state after successful factor enrollment when additional optional factors are available for enrollment</td>
      <td>Boolean</td>
      <td>TRUE</td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>warnBeforePasswordExpired</td>
      <td>Transitions transaction to <code>PASSWORD_WARN</code> state before <code>SUCCESS</code> if the user’s password is about to expire and within their password policy warn period</td>
      <td>Boolean</td>
      <td>TRUE</td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h5 id="context-object">Context Object</h5>

<p>The context object allows <a href="#trusted-application">trusted web applications</a> such as an external portal to pass additional context for the authentication or recovery transaction.</p>

<blockquote>
  <p>Overriding context such as <code>deviceToken</code> is a highly privileged operation limited to trusted web applications and requires making authentication or recovery requests with a valid <em>administrator API token</em>.</p>
</blockquote>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>DataType</th>
      <th>Nullable</th>
      <th>Unique</th>
      <th>Readonly</th>
      <th>MinLength</th>
      <th>MaxLength</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>deviceToken</td>
      <td>A globally unique ID identifying the user’s client device or user agent</td>
      <td>String</td>
      <td>TRUE</td>
      <td>FALSE</td>
      <td>FALSE</td>
      <td> </td>
      <td>32</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>You must always pass the same <code>deviceToken</code> for a user’s device with every authentication request for <strong>per-device</strong> or <strong>per-session</strong> Sign-On Policy factor challenges.  If the <code>deviceToken</code> is absent or does not match the previous <code>deviceToken</code>, the user will be challenged every-time instead of <strong>per-device</strong> or <strong>per-session</strong>.</p>
</blockquote>

<p>It is recommend that you generate a UUID or GUID for each client and persist the <code>deviceToken</code> as a persistent cookie or HTML5 localStorage item scoped to your web application’s origin.</p>

<h4 class="api api-response api-response-params" id="response-parameters">Response Parameters</h4>

<p><a href="#authentication-transaction-model">Authentication Transaction Object</a> with the current <a href="#transaction-state">state</a> for the authentication transaction.</p>

<p><code>401 Unauthorized</code> status code is returned for requests with invalid credentials or locked out accounts</p>

<pre><code class="language-http">HTTP/1.1 401 Unauthorized
Content-Type: application/json

{
  "errorCode": "E0000004",
  "errorSummary": "Authentication failed",
  "errorLink": "E0000004",
  "errorId": "oaeuHRrvMnuRga5UzpKIOhKpQ",
  "errorCauses": []
}
</code></pre>

<p><code>403 Forbidden</code> status code is returned for requests with valid credentials but the user is denied access via <strong>Sign-On Policy</strong> or <strong>MFA Policy</strong>.</p>

<blockquote>
  <p>Ensure the user is assigned to a valid <strong>MFA Policy</strong> if additional verification is required in the user’s <strong>Sign-On Policy</strong></p>
</blockquote>

<pre><code class="language-http">HTTP/1.1 403 Forbidden
Content-Type: application/json

{
    "errorCode": "E0000085",
    "errorSummary": "You do not have permission to access your account at this time.",
    "errorLink": "E0000085",
    "errorId": "oaeLngBsntPSj2IVcrEWcAZSA",
    "errorCauses": []
}
</code></pre>

<p><code>429 Too Many Requests</code> status code may be returned when the rate-limit is exceeded</p>

<blockquote>
  <p>Authentication requests are aggressively rate-limited (e.g. 1 request per username/per second) for security purposes.</p>
</blockquote>

<pre><code class="language-http">HTTP/1.1 429 Too Many Requests
Content-Type: application/json
X-Rate-Limit-Limit: 1
X-Rate-Limit-Remaining: 0
X-Rate-Limit-Reset: 1447534590

{
    "errorCode": "E0000047",
    "errorSummary": "API call exceeded rate limit due to too many requests.",
    "errorLink": "E0000047",
    "errorId": "oaeWaNHfOyQSES34-a2Dw6Phw",
    "errorCauses": []
}
</code></pre>

<h4 id="primary-authentication-with-public-application">Primary Authentication with Public Application</h4>

<p>Authenticates a user with username/password credentials via a <a href="#public-application">public application</a></p>

<h5 class="api api-request api-request-example" id="request-example">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "username": "dade.murphy@example.com",
  "password": "correcthorsebatterystaple",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "options": {
    "multiOptionalFactorEnroll": false,
    "warnBeforePasswordExpired": false
  }
}' "https://${org}.okta.com/api/v1/authn"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-success">Response Example (Success)</h5>

<p>Users with a valid password not assigned to a <strong>Sign-On Policy</strong> with additional verification requirements will successfully complete the authentication transaction.</p>

<pre><code class="language-json">{
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "SUCCESS",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "sessionToken": "00Fpzf4en68pCXTsMjcX8JPMctzN2Wiw4LDOBL_9pe",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    }
  }
}
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-invalid-credentials">Response Example (Invalid Credentials)</h5>

<p>Primary authentication requests with an invalid <code>username</code> or <code>password</code> fail with a <code>401 Unauthorized</code> error.</p>

<pre><code class="language-http">HTTP/1.1 401 Unauthorized
Content-Type: application/json

{
  "errorCode": "E0000004",
  "errorSummary": "Authentication failed",
  "errorLink": "E0000004",
  "errorId": "oaeuHRrvMnuRga5UzpKIOhKpQ",
  "errorCauses": []
}
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-access-denied">Response Example (Access Denied)</h5>

<p>Primary authentication request has valid credentials but the user is denied access via  <strong>Sign-On Policy</strong> or <strong>MFA Policy</strong> with <code>403 Forbidden</code> error.</p>

<pre><code class="language-http">HTTP/1.1 403 Forbidden
Content-Type: application/json

{
    "errorCode": "E0000085",
    "errorSummary": "You do not have permission to access your account at this time.",
    "errorLink": "E0000085",
    "errorId": "oaeLngBsntPSj2IVcrEWcAZSA",
    "errorCauses": []
}
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-locked-out">Response Example (Locked Out)</h5>

<p>Primary authentication requests for a user with <code>LOCKED_OUT</code> status is conditional on the user’s password policy.  Password policies define whether to hide or show  lockout failures which disclose a valid user identifier to the caller.</p>

<h6 id="hide-lockout-failures-default">Hide Lockout Failures (Default)</h6>

<p>If the user’s password policy is configure to <strong>hide lockout failures</strong>, a <code>401 Unauthorized</code> error is returned preventing information disclosure of a valid user identifier.</p>

<pre><code class="language-http">HTTP/1.1 401 Unauthorized
Content-Type: application/json

{
  "errorCode": "E0000004",
  "errorSummary": "Authentication failed",
  "errorLink": "E0000004",
  "errorId": "oaeuHRrvMnuRga5UzpKIOhKpQ",
  "errorCauses": []
}
</code></pre>

<h6 id="show-lockout-failures">Show Lockout Failures</h6>

<p>If the user’s password policy is configure to <strong>show lockout failures</strong>, the authentication transaction completes with <code>LOCKED_OUT</code> status.</p>

<pre><code class="language-json">{
  "status": "LOCKED_OUT",
  "_links": {
    "next": {
      "name": "unlock",
      "href": "https://your-domain.okta.com/api/v1/authn/recovery/unlock",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-expired-password">Response Example (Expired Password)</h5>

<p>User must <a href="#change-password">change their expired password</a> to complete the authentication transaction.</p>

<blockquote>
  <p>Users will be challenged for MFA (<code>MFA_REQUIRED</code>) before <code>PASSWORD_EXPIRED</code> if they have an active factor enrollment</p>
</blockquote>

<pre><code class="language-json">{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "PASSWORD_EXPIRED",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    },
    "policy": {
      "complexity": {
        "minLength": 8,
        "minLowerCase": 1,
        "minUpperCase": 1,
        "minNumber": 1,
        "minSymbol": 0
      }
    }
  },
  "_links": {
    "next": {
      "name": "changePassword",
      "href": "https://your-domain.okta.com/api/v1/authn/credentials/change_password",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-factor-challenge">Response Example (Factor Challenge)</h5>

<p>User is assigned to a <strong>Sign-On Policy</strong> that requires additional verification and must <a href="#verify-factor">select and verify</a> a previously enrolled <a href="#factor-object">factor</a> by <code>id</code> to complete the authentication transaction.</p>

<pre><code class="language-json">{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "MFA_REQUIRED",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    },
    "factors": [
      {
        "id": "rsalhpMQVYKHZKXZJQEW",
        "factorType": "token",
        "provider": "RSA",
        "profile": {
          "credentialId": "dade.murphy@example.com"
        },
        "_links": {
          "verify": {
            "href": "https://your-domain.okta.com/api/v1/authn/factors/rsalhpMQVYKHZKXZJQEW/verify",
            "hints": {
              "allow": [
                "POST"
              ]
            }
          }
        }
      },
      {
        "id": "ostfm3hPNYSOIOIVTQWY",
        "factorType": "token:software:totp",
        "provider": "OKTA",
        "profile": {
          "credentialId": "dade.murphy@example.com"
        },
        "_links": {
          "verify": {
            "href": "https://your-domain.okta.com/api/v1/authn/factors/ostfm3hPNYSOIOIVTQWY/verify",
            "hints": {
              "allow": [
                "POST"
              ]
            }
          }
        }
      },
      {
        "id": "sms193zUBEROPBNZKPPE",
        "factorType": "sms",
        "provider": "OKTA",
        "profile": {
          "phoneNumber": "+1 XXX-XXX-1337"
        },
        "_links": {
          "verify": {
            "href": "https://your-domain.okta.com/api/v1/authn/factors/sms193zUBEROPBNZKPPE/verify",
            "hints": {
              "allow": [
                "POST"
              ]
            }
          }
        }
      },
      {
        "id": "opf3hkfocI4JTLAju0g4",
        "factorType": "push",
        "provider": "OKTA",
        "profile": {
          "credentialId": "dade.murphy@example.com",
          "deviceType": "SmartPhone_IPhone",
          "name": "Gibson",
          "platform": "IOS",
          "version": "9.0"
        },
        "_links": {
          "verify": {
            "href": "https://your-domain.okta.com/api/v1/authn/factors/opf3hkfocI4JTLAju0g4/verify",
            "hints": {
              "allow": [
                "POST"
              ]
            }
          }
        }
      }
    ]
  },
  "_links": {
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-factor-enroll">Response Example (Factor Enroll)</h5>

<p>User is assigned to a <strong>MFA Policy</strong> that requires enrollment during sign-on and must <a href="#enroll-factor">select a factor to enroll</a> to complete the authentication transaction.</p>

<pre><code class="language-json">{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "MFA_ENROLL",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    },
    "factors": [
      {
        "factorType": "token",
        "provider": "RSA",
        "_links": {
          "enroll": {
            "href": "https://your-domain.okta.com/api/v1/authn/factors",
            "hints": {
              "allow": [
                "POST"
              ]
            }
          }
        }
      },
      {
        "factorType": "token:software:totp",
        "provider": "OKTA",
        "_links": {
          "enroll": {
            "href": "https://your-domain.okta.com/api/v1/authn/factors",
            "hints": {
              "allow": [
                "POST"
              ]
            }
          }
        }
      },
      {
        "factorType": "sms",
        "provider": "OKTA",
        "_links": {
          "enroll": {
            "href": "https://your-domain.okta.com/api/v1/authn/factors",
            "hints": {
              "allow": [
                "POST"
              ]
            }
          }
        }
      }
      {
        "factorType": "push",
        "provider": "OKTA",
        "_links": {
          "enroll": {
            "href": "https://your-domain.okta.com/api/v1/authn/factors",
            "hints": {
              "allow": [
                "POST"
              ]
            }
          }
        }
      }
    ]
  },
  "_links": {
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h4 id="primary-authentication-with-trusted-application">Primary Authentication with Trusted Application</h4>

<p>Authenticates a user via a <a href="#trusted-application">trusted application</a> or proxy that overrides <a href="../getting_started/design_principles.html#client-request-context">client request context</a>.</p>

<blockquote>
  <p>Specifying your own <code>deviceToken</code> is a highly privileged operation limited to trusted web applications and requires making authentication requests with a valid <em>admin API token</em>.</p>
</blockquote>

<blockquote>
  <p>The <strong>public IP address</strong> of your <a href="#trusted-application">trusted application</a> must be <a href="../getting_started/design_principles.html#ip-address">whitelisted as a gateway IP address</a> to forward the user agent’s original IP address with the <code>X-Forwarded-For</code> HTTP header</p>
</blockquote>

<h5 class="api api-request api-request-example" id="request-example-1">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-H "Authorization: SSWS ${api_token}" \
-H "User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36" \
-H "X-Forwarded-For: 23.235.46.133" \
-d '{
  "username": "dade.murphy@example.com",
  "password": "correcthorsebatterystaple",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "options": {
    "multiOptionalFactorEnroll": false,
    "warnBeforePasswordExpired": false
  },
  "context": {
    "deviceToken": "26q43Ak9Eh04p7H6Nnx0m69JqYOrfVBY"
  }
}' "https://${org}.okta.com/api/v1/authn"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example">Response Example</h5>

<pre><code class="language-json">{
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "SUCCESS",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "sessionToken": "00Fpzf4en68pCXTsMjcX8JPMctzN2Wiw4LDOBL_9pe",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    }
  }
}
</code></pre>

<h4 id="primary-authentication-with-password-expiration-warn">Primary Authentication with Password Expiration Warn</h4>

<p>Authenticates a user with a password that is about to expire.  The user should <a href="#change-password">change their password</a> to complete the authentication transaction but may opt-out (skip).</p>

<blockquote>
  <p>The <code>warnBeforePasswordExpired</code> option must be explicitly specified as <code>true</code> to allow the authentication transaction to transition to <code>PASSWORD_WARN</code> status.<br />
Non-expired passwords will successfully complete the authentication transaction if this option is omitted or <code>false</code>.</p>
</blockquote>

<h5 class="api api-request api-request-example" id="request-example-2">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "username": "dade.murphy@example.com",
  "password": "correcthorsebatterystaple",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "options": {
    "multiOptionalFactorEnroll": false,
    "warnBeforePasswordExpired": true
  }
}' "https://${org}.okta.com/api/v1/authn"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-1">Response Example</h5>

<pre><code class="language-json">{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "PASSWORD_WARN",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    },
    "policy": {
      "expiration": {
        "passwordExpireDays": 5
      },
      "complexity": {
        "minLength": 8,
        "minLowerCase": 1,
        "minUpperCase": 1,
        "minNumber": 1,
        "minSymbol": 0
      }
    }
  },
  "_links": {
    "next": {
      "name": "changePassword",
      "href": "https://your-domain.okta.com/api/v1/authn/credentials/change_password",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "skip": {
      "name": "skip",
      "href": "https://your-domain.okta.com/api/v1/authn/skip",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h3 class="api api-operation" id="change-password">Change Password</h3>

<p><span class="api-uri-template api-uri-post"><span class="api-label">POST</span> /authn/credentials/change_password</span></p>

<p>This operation changes a user’s password by providing the existing password and the new password password for authentication transactions with either the <code>PASSWORD_EXPIRED</code> or <code>PASSWORD_WARN</code> state.</p>

<ul>
  <li>A user <em>must</em> change their expired password for an authentication transaction with <code>PASSWORD_EXPIRED</code> status to successfully complete the transaction.</li>
  <li>A user <em>may</em> opt-out of changing their password (skip) when the transaction has a <code>PASSWORD_WARN</code> status</li>
</ul>

<h4 class="api api-request api-request-params" id="request-parameters-1">Request Parameters</h4>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>stateToken</td>
      <td><a href="#state-token">state token</a> for current transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>oldPassword</td>
      <td>User’s current password that is expired or about to expire</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>newPassword</td>
      <td>New password for user</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h4 class="api api-response api-response-params" id="response-parameters-1">Response Parameters</h4>

<p><a href="#authentication-transaction-model">Authentication Transaction Object</a> with the current <a href="#transaction-state">state</a> for the authentication transaction.</p>

<p>If the <code>oldPassword</code> is invalid you will receive a <code>403 Forbidden</code> status code with the following error:</p>

<pre><code class="language-http">HTTP/1.1 403 Forbidden
Content-Type: application/json

{
  "errorCode": "E0000014",
  "errorSummary": "Update of credentials failed",
  "errorLink": "E0000014",
  "errorId": "oaeYx8fd_-VQdONMI5OYcqoqw",
  "errorCauses": [
    {
      "errorSummary": "oldPassword: The credentials provided were incorrect."
    }
  ]
}
</code></pre>

<p>If the <code>newPassword</code> does not meet password policy requirements, you will receive a <code>403 Forbidden</code> status code with the following error:</p>

<pre><code class="language-http">HTTP/1.1 403 Forbidden
Content-Type: application/json

{
  "errorCode": "E0000080",
  "errorSummary": "The password does meet the complexity requirements of the current password policy.",
  "errorLink": "E0000080",
  "errorId": "oaeuNNAquYEQkWFnUVG86Abbw",
  "errorCauses": [
    {
      "errorSummary": "Passwords must have at least 8 characters, a lowercase letter, an uppercase letter, a number, no parts of your username"
    }
  ]
}
</code></pre>

<h5 class="api api-request api-request-example" id="request-example-3">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "oldPassword": "correcthorsebatterystaple",
  "newPassword": "Ch-ch-ch-ch-Changes!"
}' "https://${org}.okta.com/api/v1/authn/credentials/change_password"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-2">Response Example</h5>

<pre><code class="language-json">{
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "SUCCESS",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "sessionToken": "00Fpzf4en68pCXTsMjcX8JPMctzN2Wiw4LDOBL_9pe",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    }
  }
}
</code></pre>

<h3 class="api api-operation" id="enroll-factor">Enroll Factor</h3>

<p><span class="api-uri-template api-uri-post"><span class="api-label">POST</span> /authn/factors</span></p>

<p>Enrolls a user with a <a href="factors.html#supported-factors-for-providers">factor</a> assigned by their <strong>MFA Policy</strong>.</p>

<ul>
  <li><a href="#enroll-okta-security-question-factor">Enroll Okta Security Question Factor</a></li>
  <li><a href="#enroll-okta-sms-factor">Enroll Okta SMS Factor</a></li>
  <li><a href="#enroll-okta-verify-totp-factor">Enroll Okta Verify TOTP Factor</a></li>
  <li><a href="#enroll-okta-verify-push-factor">Enroll Okta Verify Push Factor</a></li>
  <li><a href="#enroll-google-authenticator-factor">Enroll Google Authenticator Factor</a></li>
  <li><a href="#enroll-rsa-securid-factor">Enroll RSA SecurID Factor</a></li>
  <li><a href="#enroll-symantec-vip-factor">Enroll Symantec VIP Factor</a></li>
  <li><a href="#enroll-yubikey-factor">Enroll YubiKey Factor</a></li>
</ul>

<blockquote>
  <p>This operation is only available for users that have not previously enrolled a factor and have transitioned to the <code>MFA_ENROLL</code> <a href="#transaction-state">state</a>.</p>
</blockquote>

<h4 class="api api-request api-request-params" id="request-parameters-2">Request Parameters</h4>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>stateToken</td>
      <td><a href="#state-token">state token</a> for current transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>factorType</td>
      <td>type of factor</td>
      <td>Body</td>
      <td><a href="factors.html#factor-type">Factor Type</a></td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>provider</td>
      <td>factor provider</td>
      <td>Body</td>
      <td><a href="factors.html#provider-type">Provider Type</a></td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>profile</td>
      <td>profile of a <a href="factors.html#supported-factors-for-providers">supported factor</a></td>
      <td>Body</td>
      <td><a href="factors.html#factor-profile-object">Factor Profile Object</a></td>
      <td>TRUE</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h4 class="api api-response api-response-params" id="response-parameters-2">Response Parameters</h4>

<p><a href="#authentication-transaction-model">Authentication Transaction Object</a> with the current <a href="#transaction-state">state</a> for the authentication transaction.</p>

<blockquote>
  <p>Some <a href="factors.html#factor-type">factor types</a> require <a href="#activate-factor">activation</a> to complete the enrollment process.  The <a href="#transaction-state">authentication transaction</a> will transition to <code>MFA_ENROLL_ACTIVATE</code> if a factor requires activation.</p>
</blockquote>

<h4 class="api api-operation" id="enroll-okta-security-question-factor">Enroll Okta Security Question Factor</h4>

<p>Enrolls a user with the Okta <code>question</code> factor and <a href="factors.html#question-profile">question profile</a>.</p>

<blockquote>
  <p>Security Question factor does not require activation and is <code>ACTIVE</code> after enrollment</p>
</blockquote>

<h5 class="api api-request api-request-example" id="request-example-4">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "factorType": "question",
  "provider": "OKTA",
  "profile": {
    "question": "disliked_food",
    "answer": "mayonnaise"
  }
}' "https://${org}.okta.com/api/v1/authn/factors"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-3">Response Example</h5>

<pre><code class="language-json">{
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "SUCCESS",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "sessionToken": "00OhZsSfoCtbJTrU2XkwntfEl-jCj6ck6qcU_kA049",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    }
  }
}
</code></pre>

<h4 class="api api-operation" id="enroll-okta-sms-factor">Enroll Okta SMS Factor</h4>

<p>Enrolls a user with the Okta <code>sms</code> factor and a <a href="factors.html#sms-profile">SMS profile</a>.  A text message with an OTP is sent to the device during enrollment and must be <a href="#activate-sms-factor">activated</a> by following the <code>next</code> link relation to complete the enrollment process.</p>

<h5 class="api api-request api-request-example" id="request-example-5">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "factorType": "sms",
  "provider": "OKTA",
  "profile": {
    "phoneNumber": "+1-555-415-1337"
  }
}' "https://${org}.okta.com/api/v1/authn/factors"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-4">Response Example</h5>

<blockquote>
  <p>Use the <code>resend</code> link to send another OTP if user doesn’t receive the original activation SMS OTP.</p>
</blockquote>

<pre><code class="language-json">{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "MFA_ENROLL_ACTIVATE",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    },
    "factor": {
      "id": "mbl198rKSEWOSKRIVIFT",
      "factorType": "sms",
      "provider": "OKTA",
      "profile": {
        "phoneNumber": "+1 XXX-XXX-1337"
      }
    }
  },
  "_links": {
    "next": {
      "name": "activate",
      "href": "https://your-domain.okta.com/api/v1/authn/factors/mbl198rKSEWOSKRIVIFT/lifecycle/activate",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "prev": {
      "href": "https://your-domain.okta.com/api/v1/authn/previous",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "resend": [
      {
        "name": "sms",
        "href": "https://your-domain.okta.com/api/v1/authn/factors/mbl198rKSEWOSKRIVIFT/lifecycle/resend",
        "hints": {
          "allow": [
            "POST"
          ]
        }
      }
    ]
  }
}
</code></pre>

<h4 class="api api-operation" id="enroll-okta-verify-totp-factor">Enroll Okta Verify TOTP Factor</h4>

<p>Enrolls a user with the Okta <code>token:software:totp</code> factor.  The factor must be <a href="#activate-totp-factor">activated</a> after enrollment by following the <code>next</code> link relation to complete the enrollment process.</p>

<h5 class="api api-request api-request-example" id="request-example-6">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "factorType": "token:software:totp",
  "provider": "OKTA"
}' "https://${org}.okta.com/api/v1/authn/factors"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-5">Response Example</h5>

<pre><code class="language-json">{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "MFA_ENROLL_ACTIVATE",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    },
    "factor": {
      "id": "ostf2xjtDKWFPZIKYDZV",
      "factorType": "token:software:totp",
      "provider": "OKTA",
      "profile": {
        "credentialId": "dade.murphy@example.com"
      },
      "_embedded": {
        "activation": {
          "timeStep": 30,
          "sharedSecret": "KBMTM32UJZSXQ2DW",
          "encoding": "base32",
          "keyLength": 6,
          "_links": {
            "qrcode": {
              "href": "https://your-domain.okta.com/api/v1/users/00ub0oNGTSWTBKOLGLNR/factors/ostf2xjtDKWFPZIKYDZV/qr/00Mb0zqhJQohwCDkB2wOifajAsAosEAXvDwuCmsAZs",
              "type": "image/png"
            }
          }
        }
      }
    }
  },
  "_links": {
    "next": {
      "name": "activate",
      "href": "https://your-domain.okta.com/api/v1/authn/factors/ostf2xjtDKWFPZIKYDZV/lifecycle/activate",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "prev": {
      "href": "https://your-domain.okta.com/api/v1/authn/previous",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h4 class="api api-operation" id="enroll-okta-verify-push-factor">Enroll Okta Verify Push Factor</h4>

<p>Enrolls a user with the Okta verify <code>push</code> factor. The factor must be <a href="#activate-push-factor">activated on the device</a> by scanning the QR code or visiting the activation link sent via email or sms.</p>

<blockquote>
  <p>Use the published activation links to embed the QR code or distribute an activation <code>email</code> or <code>sms</code></p>
</blockquote>

<h5 class="api api-request api-request-example" id="request-example-7">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "factorType": "push",
  "provider": "OKTA"
}' "https://${org}.okta.com/api/v1/authn/factors"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-6">Response Example</h5>

<pre><code class="language-json">{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "MFA_ENROLL_ACTIVATE",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "factorResult": "WAITING",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    },
    "factor": {
      "id": "opfh52xcuft3J4uZc0g3",
      "factorType": "push",
      "provider": "OKTA",
      "_embedded": {
        "activation": {
          "expiresAt": "2015-11-03T10:15:57.000Z",
          "_links": {
            "qrcode": {
              "href": "https://your-domain.okta.com/api/v1/users/00ub0oNGTSWTBKOLGLNR/factors/opfh52xcuft3J4uZc0g3/qr/00fukNElRS_Tz6k-CFhg3pH4KO2dj2guhmaapXWbc4",
              "type": "image/png"
            },
            "send": [
              {
                "name": "email",
                "href": "https://your-domain.okta.com/api/v1/users/00ub0oNGTSWTBKOLGLNR/factors/opfh52xcuft3J4uZc0g3/lifecycle/activate/email",
                "hints": {
                  "allow": [
                    "POST"
                  ]
                }
              },
              {
                "name": "sms",
                "href": "https://your-domain.okta.com/api/v1/users/00ub0oNGTSWTBKOLGLNR/factors/opfh52xcuft3J4uZc0g3/lifecycle/activate/sms",
                "hints": {
                  "allow": [
                    "POST"
                  ]
                }
              }
            ]
          }
        }
      }
    }
  },
  "_links": {
    "next": {
      "name": "poll",
      "href": "https://your-domain.okta.com/api/v1/authn/factors/opfh52xcuft3J4uZc0g3/lifecycle/activate/poll",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "prev": {
      "href": "https://your-domain.okta.com/api/v1/authn/previous",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h4 class="api api-operation" id="enroll-google-authenticator-factor">Enroll Google Authenticator Factor</h4>

<p>Enrolls a user with the Google <code>token:software:totp</code> factor.  The factor must be <a href="#activate-totp-factor">activated</a> after enrollment by following the <code>next</code> link relation to complete the enrollment process.</p>

<h5 class="api api-request api-request-example" id="request-example-8">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "factorType": "token:software:totp",
  "provider": "GOOGLE"
}' "https://${org}.okta.com/api/v1/authn/factors"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-7">Response Example</h5>

<pre><code class="language-json">{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "MFA_ENROLL_ACTIVATE",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    },
    "factor": {
      "id": "ostf2xjtDKWFPZIKYDZV",
      "factorType": "token:software:totp",
      "provider": "GOOGLE",
      "profile": {
        "credentialId": "dade.murphy@example.com"
      },
      "_embedded": {
        "activation": {
          "timeStep": 30,
          "sharedSecret": "KYCRM33UJZSXQ2DW",
          "encoding": "base32",
          "keyLength": 6,
          "_links": {
            "qrcode": {
              "href": "https://your-domain.okta.com/api/v1/users/00ub0oNGTSWTBKOLGLNR/factors/uftm3iHSGFQXHCUSDAND/qr/00Mb0zqhJQohwCDkB2wOifajAsAosEAXvDwuCmsAZs",
              "type": "image/png"
            }
          }
        }
      }
    }
  },
  "_links": {
    "next": {
      "name": "activate",
      "href": "https://your-domain.okta.com/api/v1/authn/factors/uftm3iHSGFQXHCUSDAND/lifecycle/activate",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "prev": {
      "href": "https://your-domain.okta.com/api/v1/authn/previous",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h4 class="api api-operation" id="enroll-rsa-securid-factor">Enroll RSA SecurID Factor</h4>

<p>Enrolls a user with a RSA SecurID factor and a <a href="factors.html#token-profile">token profile</a>.  RSA tokens must be verified with the <a href="factors.html#factor-verification-object">current pin+passcode</a> as part of the enrollment request.</p>

<h5 class="api api-request api-request-example" id="request-example-9">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-H "Authorization: SSWS ${api_token}" \
-d '{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "factorType": "token",
  "provider": "RSA",
  "profile": {
    "credentialId": "dade.murphy@example.com"
  },
  "passCode": "5275875498"
}' "https://${org}.okta.com/api/v1/users/00u15s1KDETTQMQYABRL/factors"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-8">Response Example</h5>

<pre><code class="language-json">{
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "SUCCESS",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "sessionToken": "00OhZsSfoCtbJTrU2XkwntfEl-jCj6ck6qcU_kA049",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    }
  }
}
</code></pre>

<h4 class="api api-operation" id="enroll-symantec-vip-factor">Enroll Symantec VIP Factor</h4>

<p>Enrolls a user with a Symantec VIP factor and a <a href="factors.html#token-profile">token profile</a>.  Symantec tokens must be verified with the <a href="factors.html#factor-verification-object">current and next passcodes</a> as part of the enrollment request.</p>

<h5 class="api api-request api-request-example" id="request-example-10">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-H "Authorization: SSWS ${api_token}" \
-d '{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "factorType": "token",
  "provider": "SYMANTEC",
  "profile": {
    "credentialId": "VSMT14393584"
  },
  "passCode": "875498",
  "nextPassCode": "678195"
}' "https://${org}.okta.com/api/v1/users/00u15s1KDETTQMQYABRL/factors"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-9">Response Example</h5>

<pre><code class="language-json">{
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "SUCCESS",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "sessionToken": "00OhZsSfoCtbJTrU2XkwntfEl-jCj6ck6qcU_kA049",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    }
  }
}
</code></pre>

<h4 class="api api-operation" id="enroll-yubikey-factor">Enroll YubiKey Factor</h4>

<p>Enrolls a user with a Yubico factor (YubiKey).  YubiKeys must be verified with the <a href="factors.html#factor-verification-object">current passcode</a> as part of the enrollment request.</p>

<h5 class="api api-request api-request-example" id="request-example-11">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-H "Authorization: SSWS ${api_token}" \
-d '{
  "factorType": "token:hardware",
  "provider": "YUBICO",
  "passCode": "cccccceukngdfgkukfctkcvfidnetljjiknckkcjulji"
}' "https://${org}.okta.com/api/v1/users/00u15s1KDETTQMQYABRL/factors"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-10">Response Example</h5>

<pre><code class="language-json">{
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "SUCCESS",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "sessionToken": "00OhZsSfoCtbJTrU2XkwntfEl-jCj6ck6qcU_kA049",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    }
  }
}
</code></pre>

<h3 class="api api-operation" id="activate-factor">Activate Factor</h3>

<p><span class="api-uri-template api-uri-post"><span class="api-label">POST</span> /authn/factors/<em>:fid</em>/lifecycle/activate</span></p>

<p>The <code>sms</code> and <code>token:software:totp</code> <a href="factors.html#factor-type">factor types</a> require activation to complete the enrollment process.</p>

<ul>
  <li><a href="#activate-totp-factor">Activate TOTP Factor</a></li>
  <li><a href="#activate-sms-factor">Activate SMS Factor</a></li>
  <li><a href="#activate-push-factor">Activate Push Factor</a></li>
</ul>

<h4 class="api api-operation" id="activate-totp-factor">Activate TOTP Factor</h4>

<p>Activates a <code>token:software:totp</code> factor by verifying the OTP.</p>

<h4 class="api api-request api-request-params" id="request-parameters-3">Request Parameters</h4>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>fid</td>
      <td><code>id</code> of factor returned from enrollment</td>
      <td>URL</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>stateToken</td>
      <td><a href="#state-token">state token</a>  for current transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>passCode</td>
      <td>OTP generated by device</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h4 class="api api-response api-response-params" id="response-parameters-3">Response Parameters</h4>

<p><a href="#authentication-transaction-model">Authentication Transaction Object</a> with the current <a href="#transaction-state">state</a> for the authentication transaction.</p>

<p>If the passcode is invalid you will receive a <code>403 Forbidden</code> status code with the following error:</p>

<pre><code class="language-http">HTTP/1.1 403 Forbidden
Content-Type: application/json

{
  "errorCode": "E0000068",
  "errorSummary": "Invalid Passcode/Answer",
  "errorLink": "E0000068",
  "errorId": "oaei_IfXcpnTHit_YEKGInpFw",
  "errorCauses": [
    {
      "errorSummary": "Your passcode doesn't match our records. Please try again."
    }
  ]
}
</code></pre>

<h4 class="api api-request api-request-example" id="request-example-12">Request Example</h4>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "passCode": "123456"
}' "https://${org}.okta.com/api/v1/authn/factors/ostf1fmaMGJLMNGNLIVG/lifecycle/activate"
</code></pre>

<h4 class="api api-response api-response-example" id="response-example-11">Response Example</h4>

<pre><code class="language-json">{
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "SUCCESS",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "sessionToken": "00Fpzf4en68pCXTsMjcX8JPMctzN2Wiw4LDOBL_9pe",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    }
  }
}
</code></pre>

<h4 class="api api-operation" id="activate-sms-factor">Activate SMS Factor</h4>

<p>Activates a <code>sms</code> factor by verifying the OTP.  The request/response is identical to <a href="#activate-totp-factor">activating a TOTP factor</a></p>

<h5 class="api api-request api-request-params" id="request-parameters-4">Request Parameters</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>fid</td>
      <td><code>id</code> of factor returned from enrollment</td>
      <td>URL</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>stateToken</td>
      <td><a href="#state-token">state token</a> for current transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>passCode</td>
      <td>OTP sent to mobile device</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h5 class="api api-response api-response-params" id="response-parameters-4">Response Parameters</h5>

<p><a href="#authentication-transaction-model">Authentication Transaction Object</a> with the current <a href="#transaction-state">state</a> for the authentication transaction.</p>

<p>If the passcode is invalid you will receive a <code>403 Forbidden</code> status code with the following error:</p>

<pre><code class="language-http">HTTP/1.1 403 Forbidden
Content-Type: application/json

{
  "errorCode": "E0000068",
  "errorSummary": "Invalid Passcode/Answer",
  "errorLink": "E0000068",
  "errorId": "oaei_IfXcpnTHit_YEKGInpFw",
  "errorCauses": [
    {
      "errorSummary": "Your passcode doesn't match our records. Please try again."
    }
  ]
}
</code></pre>

<h5 class="api api-request api-request-example" id="request-example-13">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "passCode": "123456"
}' "https://${org}.okta.com/api/v1/authn/factors/sms1o51EADOTFXHHBXBP/lifecycle/activate"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-12">Response Example</h5>

<pre><code class="language-json">{
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "SUCCESS",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "sessionToken": "00Fpzf4en68pCXTsMjcX8JPMctzN2Wiw4LDOBL_9pe",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    }
  }
}
</code></pre>

<h4 class="api api-operation" id="activate-push-factor">Activate Push Factor</h4>

<p>Activation of <code>push</code> factors are asynchronous and must be polled for completion when the <code>factorResult</code> returns a <code>WAITING</code> status.</p>

<p>Activations have a short lifetime (minutes) and will <code>TIMEOUT</code> if they are not completed before the <code>expireAt</code> timestamp.  Use the published <code>activate</code> link to restart the activation process if the activation is expired.</p>

<h5 class="api api-request api-request-params" id="request-parameters-5">Request Parameters</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>fid</td>
      <td><code>id</code> of factor returned from enrollment</td>
      <td>URL</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>stateToken</td>
      <td><a href="#state-token">state token</a> for current transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h5 class="api api-response api-response-params" id="response-parameters-5">Response Parameters</h5>

<p><a href="#authentication-transaction-model">Authentication Transaction Object</a> with the current <a href="#transaction-state">state</a> for the authentication transaction.</p>

<h5 class="api api-request api-request-example" id="request-example-14">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
}' "https://${org}.okta.com/api/v1/authn/factors/opfh52xcuft3J4uZc0g3/lifecycle/activate"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-waiting">Response Example (Waiting)</h5>

<blockquote>
  <p>Follow the the published <code>next</code> link to keep polling for activation completion</p>
</blockquote>

<pre><code class="language-json">{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "MFA_ENROLL_ACTIVATE",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "factorResult": "WAITING",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    },
    "factor": {
      "id": "opfh52xcuft3J4uZc0g3",
      "factorType": "push",
      "provider": "OKTA",
      "_embedded": {
        "activation": {
          "expiresAt": "2015-11-03T10:15:57.000Z",
          "_links": {
            "qrcode": {
              "href": "https://your-domain.okta.com/api/v1/users/00ub0oNGTSWTBKOLGLNR/factors/opfh52xcuft3J4uZc0g3/qr/00fukNElRS_Tz6k-CFhg3pH4KO2dj2guhmaapXWbc4",
              "type": "image/png"
            },
            "send": [
              {
                "name": "email",
                "href": "https://your-domain.okta.com/api/v1/users/00ub0oNGTSWTBKOLGLNR/factors/opfh52xcuft3J4uZc0g3/lifecycle/activate/email",
                "hints": {
                  "allow": [
                    "POST"
                  ]
                }
              },
              {
                "name": "sms",
                "href": "https://your-domain.okta.com/api/v1/users/00ub0oNGTSWTBKOLGLNR/factors/opfh52xcuft3J4uZc0g3/lifecycle/activate/sms",
                "hints": {
                  "allow": [
                    "POST"
                  ]
                }
              }
            ]
          }
        }
      }
    }
  },
  "_links": {
    "next": {
      "name": "poll",
      "href": "https://your-domain.okta.com/api/v1/authn/factors/opfh52xcuft3J4uZc0g3/lifecycle/activate/poll",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "prev": {
      "href": "https://your-domain.okta.com/api/v1/authn/previous",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-success-1">Response Example (Success)</h5>

<pre><code class="language-json">{
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "SUCCESS",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "sessionToken": "00Fpzf4en68pCXTsMjcX8JPMctzN2Wiw4LDOBL_9pe",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    }
  }
}
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-timeout">Response Example (Timeout)</h5>

<blockquote>
  <p>Follow the the published <code>activate</code> link to restart the activation process</p>
</blockquote>

<pre><code class="language-json">{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "MFA_ENROLL_ACTIVATE",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "factorResult": "TIMEOUT",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    },
    "factor": {
      "id": "opfh52xcuft3J4uZc0g3",
      "factorType": "push",
      "provider": "OKTA",
      "_embedded": {
        "activation": {
          "factorResult": "TIMEOUT",
          "_links": {
            "activate": {
              "href": "https://your-domain.okta.com/api/v1/users/00u4vi0VX6U816Kl90g4/factors/opfh52xcuft3J4uZc0g3/lifecycle/activate",
              "hints": {
                "allow": [
                  "POST"
                ]
              }
            },
            "send": [
              {
                "name": "email",
                "href": "https://your-domain.okta.com/api/v1/authn/factors/opfh52xcuft3J4uZc0g3/lifecycle/activate/email",
                "hints": {
                  "allow": [
                    "POST"
                  ]
                }
              },
              {
                "name": "sms",
                "href": "https://your-domain.okta.com/api/v1/authn/factors/opfh52xcuft3J4uZc0g3/lifecycle/activate/sms",
                "hints": {
                  "allow": [
                    "POST"
                  ]
                }
              }
            ]
          }
        }
      }
    }
  },
  "_links": {
    "next": {
      "name": "activate",
      "href": "https://your-domain.okta.com/api/v1/authn/factors/opfh52xcuft3J4uZc0g3/lifecycle/activate",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "prev": {
      "href": "https://your-domain.okta.com/api/v1/authn/previous",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h5 id="send-activation-links">Send Activation Links</h5>

<p>An activation email or sms can be sent when when the user is unable to scan the QR code.</p>

<h6 class="api api-request api-request-example" id="request-example-email">Request Example (Email)</h6>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb"
}' "https://${org}.okta.com/api/v1/authn/factors/opfh52xcuft3J4uZc0g3/lifecycle/activate/email"
</code></pre>

<h6 class="api api-request api-request-example" id="request-example-sms">Request Example (SMS)</h6>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "profile": {
    "phoneNumber": "+1-555-415-1337"
  }
}' "https://${org}.okta.com/api/v1/authn/factors/opfh52xcuft3J4uZc0g3/lifecycle/activate/sms"
</code></pre>

<h6 class="api api-response api-response-example" id="response-example-13">Response Example</h6>

<pre><code class="language-json">{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "MFA_ENROLL_ACTIVATE",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "factorResult": "WAITING",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    },
    "factor": {
      "id": "opfh52xcuft3J4uZc0g3",
      "factorType": "push",
      "provider": "OKTA",
      "_embedded": {
        "activation": {
          "expiresAt": "2015-11-03T10:15:57.000Z",
          "_links": {
            "qrcode": {
              "href": "https://your-domain.okta.com/api/v1/users/00ub0oNGTSWTBKOLGLNR/factors/opfh52xcuft3J4uZc0g3/qr/00fukNElRS_Tz6k-CFhg3pH4KO2dj2guhmaapXWbc4",
              "type": "image/png"
            },
            "send": [
              {
                "name": "email",
                "href": "https://your-domain.okta.com/api/v1/users/00ub0oNGTSWTBKOLGLNR/factors/opfh52xcuft3J4uZc0g3/lifecycle/activate/email",
                "hints": {
                  "allow": [
                    "POST"
                  ]
                }
              },
              {
                "name": "sms",
                "href": "https://your-domain.okta.com/api/v1/users/00ub0oNGTSWTBKOLGLNR/factors/opfh52xcuft3J4uZc0g3/lifecycle/activate/sms",
                "hints": {
                  "allow": [
                    "POST"
                  ]
                }
              }
            ]
          }
        }
      }
    }
  },
  "_links": {
    "next": {
      "name": "poll",
      "href": "https://your-domain.okta.com/api/v1/authn/factors/opfh52xcuft3J4uZc0g3/lifecycle/activate/poll",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "prev": {
      "href": "https://your-domain.okta.com/api/v1/authn/previous",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h3 id="verify-factor">Verify Factor</h3>

<p>Verifies an enrolled factor for an authentication transaction with the <code>MFA_REQUIRED</code> or <code>MFA_CHALLENGE</code> <a href="#transaction-state">state</a></p>

<ul>
  <li><a href="#verify-security-question-factor">Verify Security Question Factor</a></li>
  <li><a href="#verify-sms-factor">Verify SMS Factor</a></li>
  <li><a href="#verify-totp-factor">Verify TOTP Factor</a></li>
  <li><a href="#verify-push-factor">Verify Push Factor</a></li>
</ul>

<h4 class="api api-operation" id="verify-security-question-factor">Verify Security Question Factor</h4>

<p><span class="api-uri-template api-uri-post"><span class="api-label">POST</span> /authn/factors/<em>:fid</em>/verify</span></p>

<p>Verifies an answer to a <code>question</code> factor.</p>

<h5 class="api api-request api-request-params" id="request-parameters-6">Request Parameters</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>fid</td>
      <td><code>id</code> of factor returned from enrollment</td>
      <td>URL</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>stateToken</td>
      <td><a href="#state-token">state token</a> for current transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>answer</td>
      <td>answer to security question</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h5 class="api api-response api-response-params" id="response-parameters-6">Response Parameters</h5>

<p><a href="#authentication-transaction-model">Authentication Transaction Object</a> with the current <a href="#transaction-state">state</a> for the authentication transaction.</p>

<p>If the <code>answer</code> is invalid you will receive a <code>403 Forbidden</code> status code with the following error:</p>

<pre><code class="language-json">{
  "errorCode": "E0000068",
  "errorSummary": "Invalid Passcode/Answer",
  "errorLink": "E0000068",
  "errorId": "oaei_IfXcpnTHit_YEKGInpFw",
  "errorCauses": [
    {
      "errorSummary": "Your answer doesn't match our records. Please try again."
    }
  ]
}
</code></pre>

<h5 class="api api-request api-request-example" id="request-example-15">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "answer": "mayonnaise"
}' "https://${org}.okta.com/api/v1/authn/factors/ufs1pe3ISGKGPYKXRBKK/verify"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-14">Response Example</h5>

<pre><code class="language-json">{
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "SUCCESS",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "sessionToken": "00ZD3Z7ixppspFljXV2t_Z6GfrYzqG7cDJ8reWo2hy",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    }
  }
}
</code></pre>

<h4 class="api api-operation" id="verify-sms-factor">Verify SMS Factor</h4>

<p><span class="api-uri-template api-uri-post"><span class="api-label">POST</span> /authn/factors/<em>:fid</em>/verify</span></p>

<h5 class="api api-request api-request-params" id="request-parameters-7">Request Parameters</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>fid</td>
      <td><code>id</code> of factor</td>
      <td>URL</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>stateToken</td>
      <td><a href="#state-token">state token</a> for current transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>passCode</td>
      <td>OTP sent to device</td>
      <td>Body</td>
      <td>String</td>
      <td>FALSE</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>If you omit <code>passCode</code> in the request a new OTP will be sent to the device, otherwise the request will attempt to verify the <code>passCode</code></p>
</blockquote>

<h4 class="api api-response api-response-params" id="response-parameters-7">Response Parameters</h4>

<p><a href="#authentication-transaction-model">Authentication Transaction Object</a> with the current <a href="#transaction-state">state</a> for the authentication transaction.</p>

<p>If the <code>passCode</code> is invalid you will receive a <code>403 Forbidden</code> status code with the following error:</p>

<pre><code class="language-json">{
  "errorCode": "E0000068",
  "errorSummary": "Invalid Passcode/Answer",
  "errorLink": "E0000068",
  "errorId": "oaei_IfXcpnTHit_YEKGInpFw",
  "errorCauses": [
    {
      "errorSummary": "Your answer doesn't match our records. Please try again."
    }
  ]
}
</code></pre>

<h5 id="send-sms-challenge-otp">Send SMS Challenge (OTP)</h5>

<p>Omit <code>passCode</code> in the request to sent an OTP to the device</p>

<h6 class="api api-request api-request-example" id="request-example-16">Request Example</h6>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb"
}' "https://${org}.okta.com/api/v1/authn/factors/sms193zUBEROPBNZKPPE/verify"
</code></pre>

<h6 class="api api-response api-response-example" id="response-example-15">Response Example</h6>

<pre><code class="language-json">{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "MFA_CHALLENGE",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    },
    "factor": {
      "id": "sms193zUBEROPBNZKPPE",
      "factorType": "sms",
      "provider": "OKTA",
      "profile": {
        "phoneNumber": "+1 XXX-XXX-1337"
      }
    }
  },
  "_links": {
    "next": {
      "name": "verify",
      "href": "https://your-domain.okta.com/api/v1/authn/factors/sms193zUBEROPBNZKPPE/verify",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "prev": {
      "href": "https://your-domain.okta.com/api/v1/authn/previous",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "resend": [
      {
        "name": "sms",
        "href": "https://your-domain.okta.com/api/v1/authn/factors/sms193zUBEROPBNZKPPE/verify/resend",
        "hints": {
          "allow": [
            "POST"
          ]
        }
      }
    ]
  }
}
</code></pre>

<h5 id="verify-sms-challenge-otp">Verify SMS Challenge (OTP)</h5>

<p>Specify <code>passCode</code> in the request to verify the factor.</p>

<h6 class="api api-request api-request-example" id="request-example-17">Request Example</h6>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "passCode": "657866"
}' "https://${org}.okta.com/api/v1/authn/factors/sms193zUBEROPBNZKPPE/verify"
</code></pre>

<h6 class="api api-response api-response-example" id="response-example-16">Response Example</h6>

<pre><code class="language-json">{
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "SUCCESS",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "sessionToken": "00t6IUQiVbWpMLgtmwSjMFzqykb5QcaBNtveiWlGeM",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    }
  }
}
</code></pre>

<h4 class="api api-operation" id="verify-totp-factor">Verify TOTP Factor</h4>

<p><span class="api-uri-template api-uri-post"><span class="api-label">POST</span> /authn/factors/<em>:fid</em>/verify</span></p>

<p>Verifies an OTP for a <code>token:software:totp</code> factor.</p>

<h5 class="api api-request api-request-params" id="request-parameters-8">Request Parameters</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>fid</td>
      <td><code>id</code> of factor</td>
      <td>URL</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>stateToken</td>
      <td><a href="#state-token">state token</a> for current transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>passCode</td>
      <td>OTP sent to device</td>
      <td>Body</td>
      <td>String</td>
      <td>FALSE</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h5 class="api api-response api-response-params" id="response-parameters-8">Response Parameters</h5>

<p><a href="#authentication-transaction-model">Authentication Transaction Object</a> with the current <a href="#transaction-state">state</a> for the authentication transaction.</p>

<p>If the passcode is invalid you will receive a <code>403 Forbidden</code> status code with the following error:</p>

<pre><code class="language-json">{
  "errorCode": "E0000068",
  "errorSummary": "Invalid Passcode/Answer",
  "errorLink": "E0000068",
  "errorId": "oaei_IfXcpnTHit_YEKGInpFw",
  "errorCauses": [
    {
      "errorSummary": "Your passcode doesn't match our records. Please try again."
    }
  ]
}
</code></pre>

<h6 class="api api-request api-request-example" id="request-example-18">Request Example</h6>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "passCode": "657866"
}' "https://${org}.okta.com/api/v1/authn/factors/ostfm3hPNYSOIOIVTQWY/verify"
</code></pre>

<h6 class="api api-response api-response-example" id="response-example-17">Response Example</h6>

<pre><code class="language-json">{
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "SUCCESS",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "sessionToken": "00t6IUQiVbWpMLgtmwSjMFzqykb5QcaBNtveiWlGeM",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    }
  }
}
</code></pre>

<h4 class="api api-operation" id="verify-push-factor">Verify Push Factor</h4>

<p><span class="api-uri-template api-uri-post"><span class="api-label">POST</span> /authn/factors/<em>:fid</em>/verify</span></p>

<p>Sends an asynchronous push notification (challenge) to the device for the user to approve or reject.  The <code>factorResult</code> for the transaction will have a result of <code>WAITING</code>, <code>SUCCESS</code>, <code>REJECTED</code>, or <code>TIMEOUT</code>.</p>

<h5 class="api api-request api-request-params" id="request-parameters-9">Request Parameters</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>fid</td>
      <td><code>id</code> of factor returned from enrollment</td>
      <td>URL</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>stateToken</td>
      <td><a href="#state-token">state token</a> for current transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h5 class="api api-request api-request-example" id="request-example-19">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb"
}' "https://${org}.okta.com/api/v1/authn/factors/ufs1pe3ISGKGPYKXRBKK/verify"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-waiting-1">Response Example (Waiting)</h5>

<blockquote>
  <p>Keep polling authentication transactions with <code>WAITING</code> result until the challenge completes or expires.</p>
</blockquote>

<pre><code class="language-json">{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "MFA_CHALLENGE",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "factorResult": "WAITING",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    },
    "factors": {
      "id": "opfh52xcuft3J4uZc0g3",
      "factorType": "push",
      "provider": "OKTA",
      "profile": {
        "deviceType": "SmartPhone_IPhone",
        "name": "Gibson",
        "platform": "IOS",
        "version": "9.0"
      }
    }
  },
  "_links": {
    "next": {
      "name": "poll",
      "href": "https://your-domain.okta.com/api/v1/authn/factors/opfh52xcuft3J4uZc0g3/verify",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "prev": {
      "href": "https://your-domain.okta.com/api/v1/authn/previous",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "resend": [
      {
        "name": "push",
        "href": "https://your-domain.okta.com/api/v1/authn/factors/opfh52xcuft3J4uZc0g3/verify/resend",
        "hints": {
          "allow": [
            "POST"
          ]
        }
      }
    ]
  }
}
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-approved">Response Example (Approved)</h5>

<pre><code class="language-json">{
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "SUCCESS",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "sessionToken": "00Fpzf4en68pCXTsMjcX8JPMctzN2Wiw4LDOBL_9xx",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    }
  }
}
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-rejected">Response Example (Rejected)</h5>

<pre><code class="language-json">{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "MFA_CHALLENGE",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "factorResult": "REJECTED",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    },
    "factors": {
      "id": "opfh52xcuft3J4uZc0g3",
      "factorType": "push",
      "provider": "OKTA",
      "profile": {
        "deviceType": "SmartPhone_IPhone",
        "name": "Gibson",
        "platform": "IOS",
        "version": "9.0"
      }
    }
  },
  "_links": {
    "next": {
      "name": "verify",
      "href": "https://your-domain.okta.com/api/v1/authn/factors/opfh52xcuft3J4uZc0g3/verify",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "prev": {
      "href": "https://your-domain.okta.com/api/v1/authn/previous",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "resend": [
      {
        "name": "push",
        "href": "https://your-domain.okta.com/api/v1/authn/factors/opfh52xcuft3J4uZc0g3/verify/resend",
        "hints": {
          "allow": [
            "POST"
          ]
        }
      }
    ]
  }
}
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-timeout-1">Response Example (Timeout)</h5>

<pre><code class="language-json">{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "MFA_CHALLENGE",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "factorResult": "WAITING",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    },
    "factors": {
      "id": "opfh52xcuft3J4uZc0g3",
      "factorType": "push",
      "provider": "OKTA",
      "profile": {
        "deviceType": "SmartPhone_IPhone",
        "name": "Gibson",
        "platform": "IOS",
        "version": "9.0"
      }
    }
  },
  "_links": {
    "next": {
      "name": "verify",
      "href": "https://your-domain.okta.com/api/v1/authn/factors/opfh52xcuft3J4uZc0g3/verify",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "prev": {
      "href": "https://your-domain.okta.com/api/v1/authn/previous",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "resend": [
      {
        "name": "push",
        "href": "https://your-domain.okta.com/api/v1/authn/factors/opfh52xcuft3J4uZc0g3/verify/resend",
        "hints": {
          "allow": [
            "POST"
          ]
        }
      }
    ]
  }
}
</code></pre>

<h2 id="recovery-operations">Recovery Operations</h2>

<h3 class="api api-operation" id="forgot-password">Forgot Password</h3>

<p><span class="api-uri-template api-uri-post"><span class="api-label">POST</span> /authn/recovery/password</span></p>

<p>Starts a new password recovery transaction for a given user and issues a <a href="#recovery-token">recovery token</a> that can be used to reset a user’s password.</p>

<ul>
  <li><a href="#forgot-password-with-email-factor">Forgot Password with Email Factor</a></li>
  <li><a href="#forgot-password-with-sms-factor">Forgot Password with SMS Factor</a></li>
  <li><a href="#forgot-password-with-trusted-application">Forgot Password with Trusted Application</a></li>
</ul>

<blockquote>
  <p>Self-service password reset (forgot password) must be permitted via the user’s assigned password policy to use this operation.</p>
</blockquote>

<h5 class="api api-request api-request-params" id="request-parameters-10">Request Parameters</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
      <th>MaxLength</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>username</td>
      <td>User’s non-qualified short-name (e.g. dade.murphy) or unique fully-qualified login (e.g dade.murphy@example.com)</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>factorType</td>
      <td>Recovery factor to use for primary authentication</td>
      <td>Body</td>
      <td><code>EMAIL</code> or <code>SMS</code></td>
      <td>FALSE</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>relayState</td>
      <td>Optional state value that is persisted for the lifetime of the recovery transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>FALSE</td>
      <td> </td>
      <td>2048</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>A valid <code>factorType</code> is required for requests without an API token with admin privileges. (See <a href="#forgot-password-with-trusted-application">Forgot Password with Trusted Application</a>)</p>
</blockquote>

<h5 class="api api-response api-response-params" id="response-parameters-9">Response Parameters</h5>

<h6 id="public-application-1">Public Application</h6>

<p><a href="#recovery-transaction-model">Recovery Transaction Object</a> with <code>RECOVERY_CHALLENGE</code> status for the new recovery transaction.</p>

<blockquote>
  <p>You will always receive a <a href="#recovery-transaction-model">Recovery Transaction</a> response even if the requested <code>username</code> is not a valid identifier to prevent information disclosure.</p>
</blockquote>

<h6 id="trusted-application-1">Trusted Application</h6>

<p><a href="#recovery-transaction-model">Recovery Transaction Object</a> with an issued <code>recoveryToken</code> that can be distributed to the end-user.</p>

<p>You will receive a <code>403 Forbidden</code> status code if the <code>username</code> requested is not valid</p>

<pre><code class="language-http">HTTP/1.1 403 Forbidden
Content-Type: application/json

{
    "errorCode": "E0000095",
    "errorSummary": "Recovery not allowed for unknown user.",
    "errorLink": "E0000095",
    "errorId": "oaetVarN2dKS6ap08dq0k4n7A",
    "errorCauses": []
}
</code></pre>

<h4 id="forgot-password-with-email-factor">Forgot Password with Email Factor</h4>

<p>Starts a new password recovery transaction with a user identifier (<code>username</code>) and asynchronously sends a recovery email to the user’s primary and secondary email address with a <a href="#recovery-token">recovery token</a> that can be used to complete the transaction.</p>

<p>Since the recovery email is distributed out-of-band and may be viewed on a different user agent or device, this operation does not return a <a href="#state-token">state token</a> and does not have a <code>next</code> link.</p>

<blockquote>
  <p>Primary authentication of a user’s recovery credential (e.g <code>EMAIL</code> or <code>SMS</code>) has not yet completed.
Okta will not publish additional metadata about the user until primary authentication has successfully completed.</p>
</blockquote>

<h5 class="api api-request api-request-example" id="request-example-20">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "username": "dade.murphy@example.com",
  "factorType": "EMAIL",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to"
}' "https://${org}.okta.com/api/v1/authn/recovery/password"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-18">Response Example</h5>

<pre><code class="language-json">{
  "status": "RECOVERY_CHALLENGE",
  "factorResult": "WAITING",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "factorType": "EMAIL",
  "recoveryType": "PASSWORD"
}
</code></pre>

<h4 id="forgot-password-with-sms-factor">Forgot Password with SMS Factor</h4>

<p>Starts a new password recovery transaction with a user identifier (<code>username</code>) and asynchronously sends a SMS OTP (challenge) to the user’s mobile phone.  This operation will transition the recovery transaction to the <code>RECOVERY_CHALLENGE</code> state and wait for user to <a href="#verify-sms-recovery-factor">verify the OTP</a>.</p>

<blockquote>
  <p>Primary authentication of a user’s recovery credential (e.g email or SMS) has not yet completed.
Okta will not publish additional metadata about the user until primary authentication has successfully completed.</p>
</blockquote>

<blockquote>
  <p>SMS recovery factor must be enabled via the user’s assigned password policy to use this operation.</p>
</blockquote>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "username": "dade.murphy@example.com",
  "factorType": "SMS",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to"
}' "https://${org}.okta.com/api/v1/authn/recovery/password"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-19">Response Example</h5>

<pre><code class="language-json">{
  "stateToken": "00xdqXOE5qDXX8-PBR1bYv8AESqIEinDy3yul01tyh",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "RECOVERY_CHALLENGE",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "factorType": "SMS",
  "recoveryType": "PASSWORD",
  "_links": {
    "next": {
      "name": "verify",
      "href": "https://your-domain.okta.com/api/v1/authn/recovery/factors/SMS/verify",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "resend": {
      "name": "sms",
      "href": "https://your-domain.okta.com/api/v1/authn/recovery/factors/SMS/resend",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h4 id="forgot-password-with-trusted-application">Forgot Password with Trusted Application</h4>

<p>Allows a <a href="#trusted-application">trusted application</a> such as an external portal to implement it’s own primary authentication process and directly obtain a <a href="#recovery-token">recovery token</a> for a user given just the user’s identifier.</p>

<blockquote>
  <p>Directly obtaining a <code>recoveryToken</code> is a highly privileged operation that requires an administrator API token and should be restricted to trusted web applications.  Anyone that obtains a <code>recoveryToken</code> for a user and knows the answer to a user’s recovery question can reset their password or unlock their account.</p>
</blockquote>

<blockquote>
  <p>The <strong>public IP address</strong> of your <a href="#trusted-application">trusted application</a> must be <a href="../getting_started/design_principles.html#ip-address">whitelisted as a gateway IP address</a> to forward the user agent’s original IP address with the <code>X-Forwarded-For</code> HTTP header</p>
</blockquote>

<h5 class="api api-request api-request-example" id="request-example-21">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-H "Authorization: SSWS ${api_token}" \
-H "User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36" \
-H "X-Forwarded-For: 23.235.46.133" \
-d '{
  "username": "dade.murphy@example.com",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to"
}' "https://${org}.okta.com/api/v1/authn/recovery/password"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-20">Response Example</h5>

<pre><code class="language-json">{
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "RECOVERY",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "recoveryToken": "VBQ0gwBp5LyJJFdbmWCM",
  "recoveryType": "PASSWORD",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    }
  },
  "_links": {
    "next": {
      "name": "recovery",
      "href": "https://your-domain.okta.com/api/v1/authn/recovery/token",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h3 class="api api-operation" id="unlock-account">Unlock Account</h3>

<p><span class="api-uri-template api-uri-post"><span class="api-label">POST</span> /authn/recovery/unlock</span></p>

<p>Starts a new unlock recovery transaction for a given user and issues a <a href="#recovery-token">recovery token</a> that can be used to unlock a user’s account.</p>

<ul>
  <li><a href="#unlock-account-with-email-factor">Unlock Account with Email Factor</a></li>
  <li><a href="#unlock-account-with-sms-factor">Unlock Account with SMS Factor</a></li>
  <li><a href="#unlock-account-with-trusted-application">Unlock Account with Trusted Application</a></li>
</ul>

<blockquote>
  <p>Self-service unlock must be permitted via the user’s assigned password policy to use this operation.</p>
</blockquote>

<h5 class="api api-request api-request-params" id="request-parameters-11">Request Parameters</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
      <th>MaxLength</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>username</td>
      <td>User’s non-qualified short-name (e.g. dade.murphy) or unique fully-qualified login (e.g dade.murphy@example.com)</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>factorType</td>
      <td>Recovery factor to use for primary authentication</td>
      <td>Body</td>
      <td><code>EMAIL</code> or <code>SMS</code></td>
      <td>FALSE</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>relayState</td>
      <td>Optional state value that is persisted for the lifetime of the recovery transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>FALSE</td>
      <td> </td>
      <td>2048</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>A valid <code>factoryType</code> is required for requests without an API token with admin privileges. (See <a href="#unlock-account-with-trusted-application">Unlock Account with Trusted Application</a>)</p>
</blockquote>

<h5 class="api api-response api-response-params" id="response-parameters-10">Response Parameters</h5>

<h6 id="public-application-2">Public Application</h6>

<p><a href="#recovery-transaction-model">Recovery Transaction Object</a> with <code>RECOVERY_CHALLENGE</code> status for the new recovery transaction.</p>

<blockquote>
  <p>You will always receive a <a href="#recovery-transaction-model">Recovery Transaction</a> response even if the requested <code>username</code> is not a valid identifier to prevent information disclosure.</p>
</blockquote>

<h6 id="trusted-application-2">Trusted Application</h6>

<p><a href="#recovery-transaction-model">Recovery Transaction Object</a> with an issued <code>recoveryToken</code> that can be distributed to the end-user.</p>

<p>You will receive a <code>403 Forbidden</code> status code if the <code>username</code> requested is not valid</p>

<pre><code class="language-http">HTTP/1.1 403 Forbidden
Content-Type: application/json

{
    "errorCode": "E0000095",
    "errorSummary": "Recovery not allowed for unknown user.",
    "errorLink": "E0000095",
    "errorId": "oaetVarN2dKS6ap08dq0k4n7A",
    "errorCauses": []
}
</code></pre>

<h4 id="unlock-account-with-email-factor">Unlock Account with Email Factor</h4>

<p>Starts a new unlock recovery transaction with a user identifier (<code>username</code>) and asynchronously sends a recovery email to the user’s primary and secondary email address with a <a href="#recovery-token">recovery token</a> that can be used to complete the transaction.</p>

<p>Since the recovery email is distributed out-of-band and may be viewed on a different user agent or device, this operation does not return a <a href="#state-token">state token</a> and does not have a <code>next</code> link.</p>

<blockquote>
  <p>Primary authentication of a user’s recovery credential (e.g <code>EMAIL</code> or <code>SMS</code>) has not yet completed.
Okta will not publish additional metadata about the user until primary authentication has successfully completed.</p>
</blockquote>

<h5 class="api api-request api-request-example" id="request-example-22">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "username": "dade.murphy@example.com",
  "factorType": "EMAIL",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to"
}' "https://${org}.okta.com/api/v1/authn/recovery/unlock"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-21">Response Example</h5>

<pre><code class="language-json">{
  "status": "RECOVERY_CHALLENGE",
  "factorResult": "WAITING",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "factorType": "EMAIL",
  "recoveryType": "UNLOCK"
}
</code></pre>

<h4 id="unlock-account-with-sms-factor">Unlock Account with SMS Factor</h4>

<p>Starts a new unlock recovery transaction with a user identifier (<code>username</code>) and asynchronously sends a SMS OTP (challenge) to the user’s mobile phone.  This operation will transition the recovery transaction to the <code>RECOVERY_CHALLENGE</code> state and wait for user to <a href="#verify-sms-recovery-factor">verify the OTP</a>.</p>

<blockquote>
  <p>Primary authentication of a user’s recovery credential (e.g email or SMS) has not yet completed.
Okta will not publish additional metadata about the user until primary authentication has successfully completed.</p>
</blockquote>

<blockquote>
  <p>SMS recovery factor must be enabled via the user’s assigned password policy to use this operation.</p>
</blockquote>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "username": "dade.murphy@example.com",
  "factorType": "SMS",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to"
}' "https://${org}.okta.com/api/v1/authn/recovery/unlock"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-22">Response Example</h5>

<pre><code class="language-json">{
  "stateToken": "00xdqXOE5qDXX8-PBR1bYv8AESqIEinDy3yul01tyh",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "RECOVERY_CHALLENGE",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "factorType": "SMS",
  "recoveryType": "UNLOCK",
  "_links": {
    "next": {
      "name": "verify",
      "href": "https://your-domain.okta.com/api/v1/authn/recovery/factors/SMS/verify",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "resend": {
      "name": "sms",
      "href": "https://your-domain.okta.com/api/v1/authn/recovery/factors/SMS/resend",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h4 id="unlock-account-with-trusted-application">Unlock Account with Trusted Application</h4>

<p>Allows a <a href="#trusted-application">trusted application</a> such as an external portal to implement it’s own primary authentication process and directly obtain a <a href="#recovery-token">recovery token</a> for a user given just the user’s identifier.</p>

<blockquote>
  <p>Directly obtaining a <code>recoveryToken</code> is a highly privileged operation that requires an administrator API token and should be restricted to <a href="#trusted-application">trusted web applications</a>.  Anyone that obtains a <code>recoveryToken</code> for a user and knows the answer to a user’s recovery question can reset their password or unlock their account.</p>
</blockquote>

<blockquote>
  <p>The <strong>public IP address</strong> of your <a href="#trusted-application">trusted application</a> must be <a href="../getting_started/design_principles.html#ip-address">whitelisted as a gateway IP address</a> to forward the user agent’s original IP address with the <code>X-Forwarded-For</code> HTTP header</p>
</blockquote>

<h5 class="api api-request api-request-example" id="request-example-23">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-H "Authorization: SSWS ${api_token}" \
-H "User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36" \
-H "X-Forwarded-For: 23.235.46.133" \
-d '{
  "username": "dade.murphy@example.com",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to"
}' "https://${org}.okta.com/api/v1/authn/recovery/unlock"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-23">Response Example</h5>

<pre><code class="language-json">{
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "RECOVERY",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "recoveryToken": "VBQ0gwBp5LyJJFdbmWCM",
  "recoveryType": "UNLOCK",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    }
  },
  "_links": {
    "next": {
      "name": "recovery",
      "href": "https://your-domain.okta.com/api/v1/authn/recovery/token",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h3 id="verify-recovery-factor">Verify Recovery Factor</h3>

<h4 class="api api-operation" id="verify-sms-recovery-factor">Verify SMS Recovery Factor</h4>

<p><span class="api-uri-template api-uri-post"><span class="api-label">POST</span> /authn/recovery/factors/sms/verify</span></p>

<p>Verifies a SMS OTP (<code>passCode</code>) sent to the user’s mobile phone for primary authentication for a recovery transaction with <code>RECOVERY_CHALLENGE</code> status.</p>

<h5 class="api api-request api-request-params" id="request-parameters-12">Request Parameters</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>stateToken</td>
      <td><a href="#state-token">state token</a> for current recovery transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>passCode</td>
      <td>OTP sent to device</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h5 class="api api-response api-response-params" id="response-parameters-11">Response Parameters</h5>

<p><a href="#recovery-transaction-model">Recovery Transaction Object</a> with the current <a href="#transaction-state">state</a> for the recovery transaction.</p>

<p>If the <code>passCode</code> is invalid you will receive a <code>403 Forbidden</code> status code with the following error:</p>

<pre><code class="language-json">{
  "errorCode": "E0000068",
  "errorSummary": "Invalid Passcode/Answer",
  "errorLink": "E0000068",
  "errorId": "oae2uOmZcuzToCPEV2Pc_f5zw",
  "errorCauses": [
    {
      "errorSummary": "Your token doesn't match our records. Please try again."
    }
  ]
}
</code></pre>

<h5 class="api api-request api-request-example" id="request-example-24">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "00xdqXOE5qDXX8-PBR1bYv8AESqIEinDy3yul01tyh",
  "passCode": "657866"
}' "https://${org}.okta.com/api/v1/authn/factors/sms193zUBEROPBNZKPPE/verify"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-24">Response Example</h5>

<pre><code class="language-json">{
  "stateToken": "00xdqXOE5qDXX8-PBR1bYv8AESqIEinDy3yul01tyh",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "RECOVERY",
  "recoveryType": "PASSWORD",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      },
      "recovery_question": {
        "question": "Who's a major player in the cowboy scene?"
      }
    }
  },
  "_links": {
    "next": {
      "name": "answer",
      "href": "https://your-domain.okta.com/api/v1/authn/recovery/answer",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h6 class="api api-operation" id="resend-sms-recovery-challenge">Resend SMS Recovery Challenge</h6>

<p><span class="api-uri-template api-uri-post"><span class="api-label">POST</span> /authn/recovery/factors/sms/resend</span></p>

<p>Resends a SMS OTP (<code>passCode</code>) to the user’s mobile phone</p>

<h4 class="api api-request api-request-params" id="request-parameters-13">Request Parameters</h4>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>stateToken</td>
      <td><a href="#state-token">state token</a> for current recovery transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h4 class="api api-response api-response-params" id="response-parameters-12">Response Parameters</h4>

<p><a href="#recovery-transaction-model">Recovery Transaction Object</a> with the current <a href="#transaction-state">state</a> for the recovery transaction.</p>

<h4 class="api api-request api-request-example" id="request-example-25">Request Example</h4>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "00xdqXOE5qDXX8-PBR1bYv8AESqIEinDy3yul01tyh"
}' "https://${org}.okta.com/api/v1/authn/recovery/factors/sms/resend"
</code></pre>

<h4 class="api api-response api-response-example" id="response-example-25">Response Example</h4>

<pre><code class="language-json">{
  "stateToken": "00xdqXOE5qDXX8-PBR1bYv8AESqIEinDy3yul01tyh",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "RECOVERY_CHALLENGE",
  "factorType": "SMS",
  "recoveryType": "PASSWORD",
  "_links": {
    "next": {
      "name": "verify",
      "href": "https://your-domain.okta.com/api/v1/authn/recovery/factors/SMS/verify",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "resend": {
      "name": "sms",
      "href": "https://your-domain.okta.com/api/v1/authn/recovery/factors/SMS/resend",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<blockquote>
  <p>The <code>factorType</code> and <code>recoveryType</code> properties will vary depending on recovery transaction</p>
</blockquote>

<h3 class="api api-operation" id="verify-recovery-token">Verify Recovery Token</h3>

<p><span class="api-uri-template api-uri-post"><span class="api-label">POST</span> /authn/recovery/token</span></p>

<p>Validates a <a href="#recovery-token">recovery token</a> that was distributed to the end-user to continue the recovery transaction.</p>

<h5 class="api api-request api-request-params" id="request-parameters-14">Request Parameters</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>recoveryToken</td>
      <td><a href="#recovery-token">Recovery token</a> that was distributed to end-user via out-of-band mechanism such as email</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h5 class="api api-response api-response-params" id="response-parameters-13">Response Parameters</h5>

<p><a href="#recovery-transaction-model">Recovery Transaction Object</a> with a <code>RECOVERY</code> status and an issued <code>stateToken</code> that must be used to complete the recovery transaction.</p>

<p>You will receive a <code>401 Unauthorized</code> status code if you attempt to use an expired or invalid <a href="#recovery-token">recovery token</a>.</p>

<pre><code class="language-http">HTTP/1.1 401 Unauthorized
Content-Type: application/json

{
    "errorCode": "E0000011",
    "errorSummary": "Invalid token provided",
    "errorLink": "E0000011",
    "errorId": "oaeY-4G_TBUTBSZAn9n7oZCfw",
    "errorCauses": []
}
</code></pre>

<h5 class="api api-request api-request-example" id="request-example-26">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-H "Authorization: SSWS ${api_token}" \
-d '{
  "recoveryToken": "00xdqXOE5qDZX8-PBR1bYv8AESqIFinDy3yul01tyh"
}' "https://${org}.okta.com/api/v1/authn/recovery/token"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-26">Response Example</h5>

<pre><code class="language-json">{
  "stateToken": "00lMJySRYNz3u_rKQrsLvLrzxiARgivP8FB_1gpmVb",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "RECOVERY",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      },
      "recovery_question": {
        "question": "Who's a major player in the cowboy scene?"
      }
    }
  },
  "_links": {
    "next": {
      "name": "answer",
      "href": "https://your-domain.okta.com/api/v1/authn/recovery/answer",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h3 class="api api-operation" id="answer-recovery-question">Answer Recovery Question</h3>

<p><span class="api-uri-template api-uri-post"><span class="api-label">POST</span> /authn/recovery/answer</span></p>

<p>Answers the user’s recovery question to ensure only the end-user redeemed the <a href="#recovery-token">recovery token</a> for recovery transaction with a <code>RECOVERY</code> <a href="#transaction-state">status</a>.</p>

<h5 class="api api-request api-request-params" id="request-parameters-15">Request Parameters</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>stateToken</td>
      <td><a href="#state-token">state token</a> for current transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>answer</td>
      <td>answer to user’s recovery question</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h5 class="api api-response api-response-params" id="response-parameters-14">Response Parameters</h5>

<p><a href="#recovery-transaction-model">Recovery Transaction Object</a> with the current <a href="#transaction-state">state</a> for the recovery transaction.</p>

<p>You will receive a <code>403 Forbidden</code> status code if the <code>answer</code> to the user’s <a href="#recovery-question-object">recovery question</a> is invalid</p>

<pre><code class="language-http">HTTP/1.1 403 Forbidden
Content-Type: application/json

{
    "errorCode": "E0000087",
    "errorSummary": "The recovery question answer did not match our records.",
    "errorLink": "E0000087",
    "errorId": "oaeGEiIPFfeR3a_XxpezUH9ug",
    "errorCauses": []
}
</code></pre>

<h5 class="api api-request api-request-example" id="request-example-27">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-H "Authorization: SSWS ${api_token}" \
-d '{
  "stateToken": "00lMJySRYNz3u_rKQrsLvLrzxiARgivP8FB_1gpmVb",
  "answer": "Cowboy Dan"
}' "https://${org}.okta.com/api/v1/authn/recovery/answer"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-27">Response Example</h5>

<pre><code class="language-json">{
  "stateToken": "00lMJySRYNz3u_rKQrsLvLrzxiARgivP8FB_1gpmVb",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "PASSWORD_RESET",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    }
  },
  "_links": {
    "next": {
      "name": "password",
      "href": "https://your-domain.okta.com/api/v1/authn/credentials/reset_password",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h3 class="api api-operation" id="reset-password">Reset Password</h3>

<p><span class="api-uri-template api-uri-post"><span class="api-label">POST</span> /authn/credentials/reset_password</span></p>

<p>Resets a user’s password to complete a recovery transaction with a <code>PASSWORD_RESET</code> <a href="#transaction-state">state</a>.</p>

<h5 class="api api-request api-request-params" id="request-parameters-16">Request Parameters</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>stateToken</td>
      <td><a href="#state-token">state token</a> for current transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>newPassword</td>
      <td>user’s new password</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h5 class="api api-response api-response-params" id="response-parameters-15">Response Parameters</h5>

<p><a href="#recovery-transaction-model">Recovery Transaction Object</a> with the current <a href="#transaction-state">state</a> for the recovery transaction.</p>

<p>You will receive a <code>403 Forbidden</code> status code if the <code>answer</code> to the user’s <a href="#recovery-question-object">recovery question</a> is invalid.</p>

<pre><code class="language-http">HTTP/1.1 403 Forbidden
Content-Type: application/json

{
    "errorCode": "E0000087",
    "errorSummary": "The recovery question answer did not match our records.",
    "errorLink": "E0000087",
    "errorId": "oaeGEiIPFfeR3a_XxpezUH9ug",
    "errorCauses": []
}
</code></pre>

<p>You will also receive a <code>403 Forbidden</code> status code if the <code>newPassword</code> does not meet password policy requirements for the user.</p>

<pre><code class="language-http">HTTP/1.1 403 Forbidden
Content-Type: application/json

{
    "errorCode": "E0000080",
    "errorSummary": "The password does meet the complexity requirements of the current password policy.",
    "errorLink": "E0000080",
    "errorId": "oaeS4O7BUp5Roefkk_y4Z2u8Q",
    "errorCauses": [
        {
            "errorSummary": "Passwords must have at least 8 characters, a lowercase letter, an uppercase letter, a number, no parts of your username"
        }
    ]
}
</code></pre>

<h5 class="api api-request api-request-example" id="request-example-28">Request Example</h5>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-H "Authorization: SSWS ${api_token}" \
-d '{
  "stateToken": "00lMJySRYNz3u_rKQrsLvLrzxiARgivP8FB_1gpmVb",
  "newPassword": "Ch-ch-ch-ch-Changes!"
}' "https://${org}.okta.com/api/v1/authn/credentials/reset_password"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-28">Response Example</h5>

<pre><code class="language-json">{
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "SUCCESS",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "sessionToken": "00t6IUQiVbWpMLgtmwSjMFzqykb5QcaBNtveiWlGeM",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-11-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    }
  }
}
</code></pre>

<h2 id="state-management-operations">State Management Operations</h2>

<h3 class="api api-operation" id="get-transaction-state">Get Transaction State</h3>

<p><span class="api-uri-template api-uri-post"><span class="api-label">POST</span> /authn</span></p>

<p>Retrieves the current <a href="#transaction-state">transaction state</a> for a <a href="#state-token">state token</a>.</p>

<h5 class="api api-request api-request-params" id="request-parameters-17">Request Parameters</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>stateToken</td>
      <td><a href="#state-token">state token</a> for a transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h5 class="api api-response api-response-params" id="response-parameters-16">Response Parameters</h5>

<p><a href="#transaction-model">Transaction Object</a> with the current <a href="#transaction-state">state</a> for the authentication or recovery transaction.</p>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "00lMJySRYNz3u_rKQrsLvLrzxiARgivP8FB_1gpmVb"
}' "https://${org}.okta.com/api/v1/authn"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-29">Response Example</h5>

<pre><code class="language-json">{
  "stateToken": "00lMJySRYNz3u_rKQrsLvLrzxiARgivP8FB_1gpmVb",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "MFA_CHALLENGE",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    },
    "factor": {
      "id": "sms193zUBEROPBNZKPPE",
      "factorType": "sms",
      "provider": "OKTA",
      "profile": {
        "phoneNumber": "+1 XXX-XXX-1337"
      }
    }
  },
  "_links": {
    "next": {
      "name": "verify",
      "href": "https://your-domain.okta.com/api/v1/authn/factors/sms193zUBEROPBNZKPPE/verify",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    },
    "prev": {
      "href": "https://your-domain.okta.com/api/v1/authn/previous",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h3 class="api api-operation" id="previous-transaction-state">Previous Transaction State</h3>

<p><span class="api-uri-template api-uri-post"><span class="api-label">POST</span> /authn/previous</span></p>

<p>Moves the current <a href="#transaction-state">transaction state</a> back to the previous state.</p>

<h5 class="api api-request api-request-params" id="request-parameters-18">Request Parameters</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>stateToken</td>
      <td><a href="#state-token">state token</a> for a transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h5 class="api api-response api-response-params" id="response-parameters-17">Response Parameters</h5>

<p><a href="#transaction-model">Transaction Object</a> with the current <a href="#transaction-state">state</a> for the authentication or recovery transaction.</p>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "00lMJySRYNz3u_rKQrsLvLrzxiARgivP8FB_1gpmVb"
}' "https://${org}.okta.com/api/v1/authn/previous"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-30">Response Example</h5>

<pre><code class="language-json">{
  "stateToken": "007ucIX7PATyn94hsHfOLVaXAmOBkKHWnOOLG43bsb",
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "MFA_ENROLL",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-09-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    },
    "factors": [
      {
        "factorType": "token",
        "provider": "RSA",
        "_links": {
          "enroll": {
            "href": "https://your-domain.okta.com/api/v1/authn/factors",
            "hints": {
              "allow": [
                "POST"
              ]
            }
          }
        }
      },
      {
        "factorType": "token:software:totp",
        "provider": "OKTA",
        "_links": {
          "enroll": {
            "href": "https://your-domain.okta.com/api/v1/authn/factors",
            "hints": {
              "allow": [
                "POST"
              ]
            }
          }
        }
      },
      {
        "factorType": "sms",
        "provider": "OKTA",
        "_links": {
          "enroll": {
            "href": "https://your-domain.okta.com/api/v1/authn/factors",
            "hints": {
              "allow": [
                "POST"
              ]
            }
          }
        }
      }
      {
        "factorType": "push",
        "provider": "OKTA",
        "_links": {
          "enroll": {
            "href": "https://your-domain.okta.com/api/v1/authn/factors",
            "hints": {
              "allow": [
                "POST"
              ]
            }
          }
        }
      }
    ]
  },
  "_links": {
    "cancel": {
      "href": "https://your-domain.okta.com/api/v1/authn/cancel",
      "hints": {
        "allow": [
          "POST"
        ]
      }
    }
  }
}
</code></pre>

<h3 class="api api-operation" id="skip-transaction-state">Skip Transaction State</h3>

<p><span class="api-uri-template api-uri-post"><span class="api-label">POST</span> /authn/skip</span></p>

<p>Skips the current <a href="#transaction-state">transaction state</a> and advances the state machine to the next state.</p>

<blockquote>
  <p>This operation is only available for <code>MFA_ENROLL</code> or <code>PASSWORD_WARN</code> states when published as a link</p>
</blockquote>

<h5 class="api api-request api-request-params" id="request-parameters-19">Request Parameters</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>stateToken</td>
      <td><a href="#state-token">state token</a> for a transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h5 class="api api-response api-response-params" id="response-parameters-18">Response Parameters</h5>

<p><a href="#transaction-model">Transaction Object</a> with the current <a href="#transaction-state">state</a> for the authentication or recovery transaction.</p>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "00lMJySRYNz3u_rKQrsLvLrzxiARgivP8FB_1gpmVb"
}' "https://${org}.okta.com/api/v1/authn/skip"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-31">Response Example</h5>

<pre><code class="language-json">{
  "expiresAt": "2015-11-03T10:15:57.000Z",
  "status": "SUCCESS",
  "relayState": "/myapp/some/deep/link/i/want/to/return/to",
  "sessionToken": "00t6IUQiVbWpMLgtmwSjMFzqykb5QcaBNtveiWlGeM",
  "_embedded": {
    "user": {
      "id": "00ub0oNGTSWTBKOLGLNR",
      "passwordChanged": "2015-11-08T20:14:45.000Z",
      "profile": {
        "login": "dade.murphy@example.com",
        "firstName": "Dade",
        "lastName": "Murphy",
        "locale": "en_US",
        "timeZone": "America/Los_Angeles"
      }
    }
  }
}
</code></pre>

<h3 class="api api-operation" id="cancel-transaction">Cancel Transaction</h3>

<p><span class="api-uri-template api-uri-post"><span class="api-label">POST</span> /authn/cancel</span></p>

<p>Cancels the current transaction and revokes the <a href="#state-token">state token</a>.</p>

<h5 class="api api-request api-request-params" id="request-parameters-20">Request Parameters</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>stateToken</td>
      <td><a href="#state-token">state token</a> for a transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h5 class="api api-response api-response-params" id="response-parameters-19">Response Parameters</h5>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Param Type</th>
      <th>DataType</th>
      <th>Required</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>relayState</td>
      <td>Optional state value that was persisted for the authentication or recovery transaction</td>
      <td>Body</td>
      <td>String</td>
      <td>TRUE</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<pre><code class="language-sh">curl -v -X POST \
-H "Accept: application/json" \
-H "Content-Type: application/json" \
-d '{
  "stateToken": "00lMJySRYNz3u_rKQrsLvLrzxiARgivP8FB_1gpmVb"
}' "https://${org}.okta.com/api/v1/authn/cancel"
</code></pre>

<h5 class="api api-response api-response-example" id="response-example-32">Response Example</h5>

<pre><code class="language-json">{
  "relayState": "/myapp/some/deep/link/i/want/to/return/to"
}
</code></pre>
